<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Beer Translate & Games Ultimate (Mobile)</title>
    <style>
        /* --- –û–°–ù–û–í–ù–´–ï –°–¢–ò–õ–ò --- */
        body { background-color: #121316; color: #e8eaed; font-family: 'Segoe UI', sans-serif; display: flex; flex-direction: column; align-items: center; justify-content: center; min-height: 100vh; margin: 0; overflow: hidden; user-select: none; -webkit-user-select: none; }
        
        /* –ó–∞–≥–æ–ª–æ–≤–æ–∫ */
        .title-container { margin-bottom: 20px; display: flex; flex-direction: column; align-items: center; gap: 5px; cursor: grab; z-index: 20; text-align: center; }
        h1 { font-weight: 400; font-size: 28px; color: #bdc1c6; margin: 0; pointer-events: none; line-height: 1.2; }
        .secret-link { color: inherit; text-decoration: none; cursor: pointer; pointer-events: auto; transition: color 0.2s; }
        .secret-link:hover { color: #8ab4f8; }
        .author-tag { font-size: 12px; color: #5f6368; font-weight: 500; opacity: 0.7; pointer-events: none; }

        /* –ü–µ—Ä–µ–≤–æ–¥—á–∏–∫ */
        .translator-container { background-color: #1e1f21; border: 1px solid #3c4043; border-radius: 12px; width: 95%; max-width: 1100px; height: 80vh; display: flex; flex-direction: column; box-shadow: 0 10px 30px rgba(0,0,0,0.5); position: relative; z-index: 10; transition: transform 0.1s ease-out; }
        .header-tabs { display: flex; align-items: center; padding: 0 10px; border-bottom: 1px solid #3c4043; height: 50px; flex-shrink: 0; justify-content: space-between; }
        .tab-group { display: flex; align-items: center; height: 100%; }
        .tab { color: #8ab4f8; font-size: 14px; font-weight: 500; border-bottom: 2px solid #8ab4f8; height: 100%; display: flex; align-items: center; padding: 0 8px; cursor: pointer; white-space: nowrap; }
        .tab.inactive { border-bottom: 2px solid transparent; color: #9aa0a6; }
        .swap-icon { margin: 0 10px; color: #9aa0a6; cursor: pointer; font-size: 20px; padding: 5px; }
        
        .right-tabs { display: flex; gap: 5px; }
        .action-tab { color: #9aa0a6; font-size: 12px; text-transform: uppercase; font-weight: bold; cursor: pointer; padding: 6px 8px; border-radius: 4px; background: rgba(255,255,255,0.03); border: 1px solid #3c4043; }
        .action-tab:active { color: #fff; background: rgba(255,255,255,0.1); }

        .main-panels { display: flex; flex-direction: row; height: 100%; overflow: hidden; }
        .panel { flex: 1; padding: 15px; position: relative; display: flex; flex-direction: column; background: #1e1f21; box-sizing: border-box; min-width: 0; }
        .input-panel { border-right: 1px solid #3c4043; }
        
        textarea { width: 100%; height: 100%; background: transparent; border: none; color: #fff; font-size: 18px; resize: none; outline: none; font-family: inherit; -webkit-overflow-scrolling: touch; }
        #output-field { font-size: 18px; color: #bdc1c6; word-break: break-all; white-space: pre-wrap; flex-grow: 1; overflow-y: auto; -webkit-overflow-scrolling: touch; }
        
        .clear-btn { position: absolute; top: 10px; right: 10px; color: #9aa0a6; cursor: pointer; font-size: 24px; z-index: 5; padding: 5px; background: rgba(30,31,33,0.8); border-radius: 50%; }
        
        .copy-btn { background: #303134; border: 1px solid #3c4043; color: #9aa0a6; cursor: pointer; padding: 8px 12px; border-radius: 20px; transition: all 0.2s; display: flex; align-items: center; gap: 5px; font-size: 12px; text-transform: uppercase; font-weight: bold; }
        .copy-btn:active { color: #fff; background: #3c4043; transform: scale(0.95); }

        /* --- –ú–û–î–ê–õ–¨–ù–û–ï –û–ö–ù–û (–ò–ì–†–´) --- */
        .modal-overlay { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.85); z-index: 5000; justify-content: center; align-items: center; backdrop-filter: blur(5px); }
        .game-window { background: #1e1f21; border: 1px solid #3c4043; border-radius: 12px; width: 800px; max-width: 95%; height: 600px; max-height: 90vh; overflow: hidden; display: flex; flex-direction: column; box-shadow: 0 20px 50px rgba(0,0,0,0.7); position: relative; }
        
        .game-header { padding: 12px 15px; border-bottom: 1px solid #3c4043; display: flex; justify-content: space-between; align-items: center; background: #202124; height: 50px; box-sizing: border-box; }
        .game-header h2 { margin: 0; font-size: 16px; color: #bdc1c6; font-weight: 500; }
        .close-game { color: #9aa0a6; cursor: pointer; font-size: 24px; padding: 5px; width: 30px; text-align: center; }

        /* –ú–µ–Ω—é –∏–≥—Ä */
        .game-menu { display: grid; grid-template-columns: repeat(auto-fill, minmax(160px, 1fr)); gap: 10px; padding: 15px; overflow-y: auto; }
        .game-card { background: #303134; border: 1px solid #3c4043; border-radius: 10px; padding: 15px; text-align: center; cursor: pointer; transition: all 0.1s; display: flex; flex-direction: column; align-items: center; gap: 8px; }
        .game-card:active { background: #3c4043; border-color: #8ab4f8; }
        .game-card .icon { font-size: 36px; }
        .game-card .name { font-weight: bold; color: #e8eaed; font-size: 14px; }
        .game-card .desc { font-size: 11px; color: #9aa0a6; }

        .game-content { display: none; flex-direction: column; height: 100%; position: relative; overflow: hidden; }
        .back-to-menu { padding: 10px 15px; background: #252629; border-bottom: 1px solid #3c4043; color: #8ab4f8; cursor: pointer; z-index: 100; font-weight: 500; display: flex; align-items: center; gap: 5px; font-size: 14px; }

        /* --- –ß–ê–¢ --- */
        #forumContainer { padding: 0; }
        .forum-posts { flex: 1; overflow-y: auto; padding: 15px; display: flex; flex-direction: column; gap: 12px; background: #121316; -webkit-overflow-scrolling: touch; }
        .post-card { background: #1e1f21; border: 1px solid #3c4043; padding: 10px; border-radius: 12px; max-width: 90%; align-self: flex-start; }
        .post-card.own-post { align-self: flex-end; background: #1a2634; border-color: #3a5a7a; }
        .post-author { font-size: 12px; margin-bottom: 4px; display: flex; justify-content: space-between; align-items: center; gap: 10px; }
        .post-avatar { width: 28px; height: 28px; border-radius: 50%; object-fit: cover; margin-right: 6px; background: #303134; }
        .post-text { font-size: 14px; line-height: 1.4; color: #e8eaed; word-break: break-word; }
        .post-img { max-width: 100%; border-radius: 8px; margin-top: 8px; display: block; max-height: 250px; object-fit: contain; border: 1px solid #3c4043; }
        
        .forum-input-area { padding: 10px; background: #202124; border-top: 1px solid #3c4043; display: flex; gap: 8px; align-items: flex-end; }
        .current-user-bar { padding: 6px; font-size: 11px; margin-bottom: 5px; }
        .current-user-bar .avatar-small { width: 24px; height: 24px; }
        
        .forum-inputs-left { display: flex; flex-direction: column; gap: 6px; flex: 1; min-width: 0; }
        .forum-toolbar { display: flex; align-items: center; gap: 8px; }
        .attach-btn, .voice-btn { width: 40px; height: 40px; border-radius: 8px; font-size: 20px; flex-shrink: 0; }
        
        #forumText { min-height: 36px; padding: 8px; font-size: 14px; max-height: 80px; }
        .send-btn { width: 42px; height: 42px; border-radius: 8px; font-size: 20px; }

        /* –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –º–æ–±–∏–ª—å–Ω–∞—è */
        .auth-screen { padding: 15px; width: 100%; box-sizing: border-box; overflow-y: auto; }
        .auth-tab { padding: 12px 10px; font-size: 14px; flex: 1; text-align: center; }
        .auth-form input { padding: 12px; font-size: 16px; } /* 16px to prevent ios zoom */
        .auth-submit { padding: 14px; font-size: 16px; }

        /* --- –ò–ì–†–´: –ê–î–ê–ü–¢–ê–¶–ò–Ø --- */
        
        /* –ö–õ–ò–ö–ï–† */
        .clicker-layout { display: flex; height: 100%; width: 100%; }
        .clicker-main { flex: 1; display: flex; flex-direction: column; align-items: center; padding: 20px; background: radial-gradient(circle at center, #2c2d30 0%, #121316 100%); }
        .clicker-stats { position: static; margin-bottom: 20px; text-align: center; }
        #beerCount { font-size: 32px; }
        .big-cookie-container { width: 200px; height: 200px; margin-top: 0; }
        .clicker-shop { width: 35%; min-width: 200px; background: #202124; border-left: 1px solid #3c4043; display: flex; flex-direction: column; }
        #storeList { flex: 1; overflow-y: auto; }
        .building-item { padding: 10px; }
        .b-icon { font-size: 24px; width: 36px; height: 36px; }
        .b-name { font-size: 12px; }
        .b-cost { font-size: 11px; }

        /* –°–ê–ü–ï–† */
        .mines-container { padding: 10px; }
        .mines-grid { display: grid; grid-template-columns: repeat(10, 1fr); gap: 2px; background: #3c4043; border: 2px solid #3c4043; width: 100%; max-width: 320px; aspect-ratio: 1/1; }
        .mine-cell { width: 100%; height: 100%; font-size: 14px; }
        
        /* –ó–ú–ï–ô–ö–ê */
        .snake-container { padding: 10px; }
        #snake-canvas { width: 100%; max-width: 400px; height: auto; aspect-ratio: 1/1; background: #000; border: 2px solid #303134; }

        /* –§–õ–ê–ì–ò */
        .geo-container { padding: 20px; }
        #geoFlag { font-size: 80px; }
        #geoOptions { grid-template-columns: 1fr; width: 100%; max-width: 300px; }
        .geo-btn { padding: 12px; font-size: 14px; }

        /* –ö–ê–ó–ò–ù–û */
        .casino-card { width: 90%; max-width: 350px; padding: 25px; }

        /* --- MEDIA QUERIES (–ú–û–ë–ò–õ–¨–ù–ê–Ø –í–ï–†–°–ò–Ø) --- */
        @media (max-width: 768px) {
            .title-container h1 { font-size: 24px; }
            .translator-container { width: 100%; height: 100vh; max-width: none; border: none; border-radius: 0; }
            .main-panels { flex-direction: column; }
            .panel { min-height: auto; border-right: none; border-bottom: 1px solid #3c4043; padding: 15px; }
            .panel:last-child { border-bottom: none; background: #1a1b1d; }
            .input-panel { flex: 1; }
            .panel:nth-child(2) { flex: 1; }
            
            textarea { font-size: 16px; }
            #output-field { font-size: 16px; }
            .clear-btn { visibility: visible; }

            /* –ò–≥—Ä–æ–≤–æ–µ –æ–∫–Ω–æ –Ω–∞ –≤–µ—Å—å —ç–∫—Ä–∞–Ω */
            .game-window { width: 100%; height: 100%; border-radius: 0; border: none; max-height: 100%; }
            .game-menu { grid-template-columns: 1fr 1fr; gap: 8px; padding: 10px; }
            
            /* –ö–ª–∏–∫–µ—Ä - –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω–∞—è —Ä–∞—Å–∫–ª–∞–¥–∫–∞ */
            .clicker-layout { flex-direction: column; }
            .clicker-main { height: 50%; padding: 10px; }
            .big-cookie-container { width: 160px; height: 160px; }
            .clicker-shop { width: 100%; height: 50%; border-left: none; border-top: 1px solid #3c4043; }
            
            /* –ó–º–µ–π–∫–∞ –∫–Ω–æ–ø–∫–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è (–µ—Å–ª–∏ –Ω—É–∂–Ω—ã –±—É–¥—É—Ç, –ø–æ–∫–∞ —Å–≤–∞–π–ø—ã –∏–ª–∏ —Ç–∞–ø) */
            /* –ù–∞ —Å–∞–º–æ–º –¥–µ–ª–µ –≤ –∫–æ–¥–µ –∑–º–µ–π–∫–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å—Ç—Ä–µ–ª–∫–∞–º–∏, –Ω–∞ —Ç–µ–ª–µ—Ñ–æ–Ω–µ –Ω—É–∂–Ω–∞ –±—É–¥–µ—Ç –≤–∏—Ä—Ç –∫–ª–∞–≤–∏–∞—Ç—É—Ä–∞ –∏–ª–∏ –∫–Ω–æ–ø–∫–∏. 
               –î–æ–±–∞–≤–∏–º –ø—Ä–æ—Å—Ç—ã–µ –∫–Ω–æ–ø–∫–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –Ω–∏–∂–µ */
            .snake-controls { display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 5px; margin-top: 10px; }
            .s-btn { background: #303134; border: 1px solid #3c4043; color: #fff; padding: 15px; border-radius: 8px; text-align: center; font-size: 20px; }
        }
    </style>
</head>
<body>

    <div class="title-container">
        <h1>
            <a href="https://www.roblox.com/games/111530421351096/You-VS-Homer#!/game-instances" class="secret-link">B</a>ee<a href="https://beerlanguage.ru/rat" class="secret-link">r</a> 
            Tran<a href="https://beerlanguage.ru/Caesar" class="secret-link">s</a>late
        </h1>
        <span class="author-tag">Ultimate Mobile</span>
    </div>

    <div class="translator-container" id="main-block">
        <div class="header-tabs">
            <div class="tab-group">
                <div class="tab" id="left-label">–¢–µ–∫—Å—Ç</div>
                <div class="swap-icon" onclick="toggleMode()">‚áÑ</div>
                <div class="tab inactive" id="right-label">–ü–∏–≤–Ω–æ–π</div>
            </div>
            <div class="right-tabs">
                <div class="action-tab" onclick="openGameModal()">üéÆ –ò–≥—Ä—ã</div>
            </div>
        </div>
        <div class="main-panels">
            <div class="panel input-panel">
                <div class="clear-btn" onclick="clearInput()">‚úï</div>
                <textarea id="input-text" placeholder="–í–≤–µ–¥–∏—Ç–µ —Ç–µ–∫—Å—Ç..." oninput="doTranslate()"></textarea>
            </div>
            <div class="panel">
                <div id="output-field"></div>
                <div style="position: absolute; bottom: 12px; right: 12px;">
                    <button class="copy-btn" onclick="copyToClipboard()">
                        –ö–û–ü–ò–†–û–í–ê–¢–¨
                    </button>
                </div>
            </div>
        </div>
    </div>

    <div class="modal-overlay" id="gameModal">
        <div class="game-window">
            <div class="game-header">
                <h2 id="gameTitle">–ò–≥—Ä–æ–≤–æ–µ –ú–µ–Ω—é</h2>
                <div class="close-game" onclick="closeGameModal()">‚úï</div>
            </div>
            
            <div class="game-menu" id="gameMenu">
                <div class="game-card" onclick="openForum()">
                    <div class="icon">üí¨</div>
                    <div class="name">–ß–ê–¢</div>
                </div>
                <div class="game-card" onclick="openClicker()">
                    <div class="icon">üç∫</div>
                    <div class="name">Clicker</div>
                </div>
                <div class="game-card" onclick="openMines()">
                    <div class="icon">üí£</div>
                    <div class="name">–°–∞–ø–µ—Ä</div>
                </div>
                <div class="game-card" onclick="openSnake()">
                    <div class="icon">üêç</div>
                    <div class="name">–ó–º–µ–π–∫–∞</div>
                </div>
                <div class="game-card" onclick="openGeo()">
                    <div class="icon">üåç</div>
                    <div class="name">–§–ª–∞–≥–∏</div>
                </div>
                <div class="game-card" onclick="openCasino()">
                    <div class="icon">üé≤</div>
                    <div class="name">–ö–∞–∑–∏–Ω–æ</div>
                </div>
            </div>

            <div id="forumContainer" class="game-content">
                <div class="back-to-menu" onclick="backToMenu()">‚Üê –ù–∞–∑–∞–¥ –∫ –∏–≥—Ä–∞–º</div>
                
                <div id="authScreen" class="auth-screen">
                    <div class="auth-tabs">
                        <div class="auth-tab active" onclick="showAuthTab('register')">–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</div>
                        <div class="auth-tab" onclick="showAuthTab('login')">–í—Ö–æ–¥</div>
                    </div>
                    
                    <div style="margin: 20px 0;">
                        <button type="button" class="auth-submit guest-btn" style="background:#303134; color:#9aa0a6; border:none; border-radius:8px; width:100%; padding:12px;" onclick="enterAsGuest()">–í–æ–π—Ç–∏ –ì–æ—Å—Ç–µ–º</button>
                    </div>
                    
                    <div id="registerForm" class="auth-form active">
                        <label>–ù–∏–∫–Ω–µ–π–º</label>
                        <input type="text" id="regNickname" maxlength="30">
                        <label>–ü–∞—Ä–æ–ª—å</label>
                        <input type="password" id="regPassword">
                        <label>–ö–æ–¥–æ–≤–æ–µ —Å–ª–æ–≤–æ</label>
                        <input type="text" id="regCodeWord">
                        <label>–ê–≤–∞—Ç–∞—Ä (–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)</label>
                        <div class="avatar-upload-wrap" style="margin-top:10px;">
                            <img id="regAvatarPreview" class="avatar-preview" src="" alt="" style="display:none; width:50px; height:50px; border-radius:50%;">
                            <label style="padding:10px; background:#303134; border-radius:8px; display:inline-block;"><input type="file" id="regAvatarInput" accept="image/*" style="display:none;"> üì∏ –ó–∞–≥—Ä—É–∑–∏—Ç—å —Ñ–æ—Ç–æ</label>
                        </div>
                        <button class="auth-submit" style="background:#8ab4f8; border:none; border-radius:8px; margin-top:15px; width:100%; color:#000; font-weight:bold;" onclick="doRegister()">–°–æ–∑–¥–∞—Ç—å –∞–∫–∫–∞—É–Ω—Ç</button>
                    </div>

                    <div id="loginForm" class="auth-form">
                        <label>–ù–∏–∫–Ω–µ–π–º</label>
                        <input type="text" id="loginNickname">
                        <label>–ü–∞—Ä–æ–ª—å</label>
                        <input type="password" id="loginPassword">
                        <label>–ö–æ–¥–æ–≤–æ–µ —Å–ª–æ–≤–æ</label>
                        <input type="text" id="loginCodeWord">
                        <button class="auth-submit" style="background:#8ab4f8; border:none; border-radius:8px; margin-top:15px; width:100%; color:#000; font-weight:bold;" onclick="doLogin()">–í–æ–π—Ç–∏</button>
                    </div>
                </div>

                <div id="chatArea" style="display:none; flex:1; flex-direction:column; overflow:hidden;">
                    <div class="forum-posts" id="forumPosts"></div>
                    <div class="forum-input-area">
                        <div class="forum-inputs-left">
                            <div class="current-user-bar">
                                <img id="myAvatarImg" class="avatar-small" src="" alt="">
                                <span class="nick" id="myNickname">...</span>
                                <span class="logout-btn" onclick="doLogout()" style="margin-left:auto; color:#ea4335;">–í—ã–π—Ç–∏</span>
                            </div>
                            <div class="guest-limit-notice" id="guestLimitNotice" style="display:none; font-size:10px; color:#f29900;">
                                –ì–æ—Å—Ç—å: <span id="guestLimitCount">0</span>/10.
                            </div>
                            <div class="attachments-preview" id="attachmentsPreview"></div>
                            <div style="display:flex; gap:5px; width:100%;">
                                <button type="button" class="attach-btn" style="background:#303134; border:1px solid #3c4043; color:#9aa0a6;" onclick="document.getElementById('attachFileInput').click()">üìé</button>
                                <button type="button" class="voice-btn" id="voiceBtn" style="background:#303134; border:1px solid #3c4043; color:#9aa0a6;" onclick="toggleVoiceRecord()">üé§</button>
                                <textarea id="forumText" placeholder="–°–æ–æ–±—â–µ–Ω–∏–µ..." style="background:#303134; border:1px solid #3c4043; border-radius:6px; color:#fff; flex:1; resize:none;"></textarea>
                            </div>
                            <input type="file" id="attachFileInput" multiple style="display:none;" onchange="handleFileSelect(this)">
                        </div>
                        <button class="send-btn" id="sendPostBtn" style="background:#8ab4f8; border:none; color:#1e1f21;" onclick="sendPost()">‚û§</button>
                    </div>
                </div>
            </div>

            <div id="clickerContainer" class="game-content">
                <div class="back-to-menu" onclick="backToMenu(); saveClicker();">‚Üê –í –º–µ–Ω—é (–°–æ—Ö—Ä–∞–Ω–∏—Ç—å)</div>
                <div class="clicker-layout">
                    <div class="clicker-main">
                        <div class="clicker-stats">
                            <div id="beerCount">0 –ü–∏–≤–∞</div>
                            <div id="beerCps" style="color:#9aa0a6; font-size:14px;">–≤ —Å–µ–∫—É–Ω–¥—É: 0</div>
                        </div>
                        <div class="big-cookie-container">
                            <div class="big-cookie" id="bigCookie" style="width:100%; height:100%; background: url('https://img.icons8.com/color/480/beer-glass.png') no-repeat center/contain;"></div>
                        </div>
                    </div>
                    <div class="clicker-shop">
                        <div class="shop-header" style="padding:10px; background:#303134; text-align:center; font-weight:bold;">–ú–∞–≥–∞–∑–∏–Ω</div>
                        <div id="storeList"></div>
                    </div>
                </div>
            </div>

            <div id="minesContainer" class="game-content">
                <div class="back-to-menu" onclick="backToMenu()">‚Üê –ù–∞–∑–∞–¥</div>
                <div class="mines-container">
                    <div style="font-size: 18px; font-weight: bold; color: #bdc1c6; margin-bottom:10px;">–°–ê–ü–ï–†</div>
                    <div class="mines-grid" id="minesGrid"></div>
                    <button class="geo-btn" onclick="initMinesweeper()" style="padding: 10px 20px; margin-top:20px;">–ó–∞–Ω–æ–≤–æ</button>
                </div>
            </div>

            <div id="snakeContainer" class="game-content">
                <div class="back-to-menu" onclick="backToMenu()">‚Üê –ù–∞–∑–∞–¥</div>
                <div class="snake-container">
                    <div id="snakeScore" style="font-size: 20px; font-weight: bold;">–°—á–µ—Ç: 0</div>
                    <canvas id="snake-canvas" width="400" height="400"></canvas>
                    
                    <div class="snake-controls" style="display:none;" id="mobileSnakeControls">
                        <div></div>
                        <div class="s-btn" onclick="setSnakeDir(0, -1)">‚ñ≤</div>
                        <div></div>
                        <div class="s-btn" onclick="setSnakeDir(-1, 0)">‚óÄ</div>
                        <div class="s-btn" onclick="setSnakeDir(0, 1)">‚ñº</div>
                        <div class="s-btn" onclick="setSnakeDir(1, 0)">‚ñ∂</div>
                    </div>
                </div>
            </div>

            <div id="geoContainer" class="game-content">
                <div class="back-to-menu" onclick="backToMenu()">‚Üê –ù–∞–∑–∞–¥</div>
                <div class="geo-container">
                    <div id="geoScoreDisplay" style="font-size: 20px; font-weight: bold; color: #8ab4f8;">–°—á–µ—Ç: 0</div>
                    <div id="geoFlag"></div>
                    <div id="geoOptions"></div>
                </div>
            </div>

            <div id="casinoContainer" class="game-content">
                <div class="back-to-menu" onclick="backToMenu()">‚Üê –ù–∞–∑–∞–¥</div>
                <div class="casino-container">
                    <div class="casino-card">
                        <div class="balance-label">–ë–∞–ª–∞–Ω—Å</div>
                        <div id="casinoBalance" style="font-size:36px; color:#81c995; margin:10px 0;">$10</div>
                        <div class="bet-input-wrap">
                            <input type="number" id="casinoBet" value="10" min="1" style="width:100%; box-sizing:border-box; padding:10px; background:#303134; border:1px solid #3c4043; color:#fff; border-radius:8px;">
                            <div class="bet-btns">
                                <button class="geo-btn" style="padding: 10px;" onclick="adjustBet(0.5)">x0.5</button>
                                <button class="geo-btn" style="padding: 10px;" onclick="adjustBet(2)">x2</button>
                            </div>
                        </div>
                        <button class="bet-action" style="width:100%; margin-top:10px;" onclick="playCasino()">–ü–û–°–¢–ê–í–ò–¢–¨</button>
                        <div id="casinoMsg"></div>
                    </div>
                </div>
            </div>

        </div>
    </div>

<script>
    // --- –ü–†–û–í–ï–†–ö–ê –ú–û–ë–ò–õ–¨–ù–û–°–¢–ò ---
    var isMobile = /iPhone|iPad|iPod|Android|BlackBerry|Opera Mini|IEMobile/i.test(navigator.userAgent) || window.innerWidth < 768;
    if(isMobile) {
        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∫–Ω–æ–ø–∫–∏ –∑–º–µ–π–∫–∏ –Ω–∞ –º–æ–±–∏–ª—å–Ω–æ–º
        document.addEventListener("DOMContentLoaded", () => {
             const controls = document.getElementById('mobileSnakeControls');
             if(controls) controls.style.display = 'grid';
        });
    }

    // --- –î–ê–ù–ù–´–ï –ò –ü–ï–†–ï–í–û–î ---
    const beerMap = {'–ê': '–≤–ª–¥–∞–æ–ª–¥—Ü—Ç3894', '–ë': '78–µ–º9—Ç4325243895—Ç–º72', '–í': '–∞—Ç–¥–ª–∂–∏—ã—Ñ–≤–µ–∏0653', '–ì': '—Ç–º—â—ã—à–µ–≤–∑34', '–î': '34—Ç—Ä–∏537—É–∏–∞–¥–ª–≤—ã', '–ï': '—å02–º392–º7', '–Å': '—å02–º392–º8', '–ñ': '—Ç—Ç32–º4–æ35—Ç2', '–ó': '3–∏45—Ä—Ç647—å8', '–ò': '49–∏357—Ç7—Ç50–∏—Ü7', '–ô': '49–∏357—Ç7—Ç50–∏—Ü8', '–ö': '—Ç–π89–∏5446', '–õ': '7—å—Ç47—Ç—Ç—å75', '–ú': '7—å65–±—å47456—å7', '–ù': '8674—å5–±867–∫—É–µ–∫–≤', '–û': '—å7—Ç3567–æ5643654', '–ü': '—Ç76376534—ã–≤—Ç–Ω', '–†': '–≤—å—Ç–∞–ø–≥—å67767—å5–∫–µ', '–°': '–ø–∏–∞–≤—ã–µ54', '–¢': '—Ç65436–æ—Ç–µ–∫–Ω—Ä', '–£': '6—Ç54—É65—Ç6—Ü—É3', '–§': '74567–æ5—Ç–Ω–∏—Ç7546', '–•': '547—Ç456756—Ç85', '–¶': '7–ª—å564–ª7–æ—Ç546—Ä546', '–ß': '87645—å—Ç5–∫—É—å–ª–Ω–∞–µ–Ω–≥–µ–Ω', '–®': '–∞–µ—Ç–∫—É–Ω—É45654–Ω', '–©': '–∞–µ—Ç–∫—É–Ω—É45654–Ω1', '–™': '22987—Ç6–∏0222–ª–≤–¥–ø—Ñ—ã1', '–´': '22987—Ç6–∏0222–ª–≤–¥–ø—Ñ—ã3', '–¨': '22987—Ç6–∏0222–ª–≤–¥–ø—Ñ—ã2', '–≠': '638—å54–∏96346–∏0345', '–Æ': '–µ0—Ü4539–∏587—Ç3450879345', '–Ø': '–µ—å–µ–∫—É—Ç–Ω—Ç–µ–∫6–Ω—è', 'A': 'z99x11v', 'B': 'bb77beer00', 'C': 'c_shakal_99', 'D': 'd88_vottak_2', 'E': 'e_pivo_1', 'F': 'f_44_ff', 'G': 'g_top_g_7', 'H': 'h_hh_888', 'I': 'i_eye_111', 'J': 'j_jack_55', 'K': 'k_kick_0', 'L': 'l_lose_77', 'M': 'm_m_444555', 'N': 'n_nitro_9', 'O': 'o_zero_00', 'P': 'p_pub_4', 'Q': 'q_quest_1', 'R': 'r_root_66', 'S': 's_snk_33', 'T': 't_tank_4', 'U': 'u_unit_22', 'V': 'v_v_666', 'W': 'w_wow_7', 'X': 'x_xxx_0', 'Y': 'y_yes_9', 'Z': 'z_zzz_1'};
    const reverseCodes = Object.entries(beerMap).map(([letter, code]) => ({ letter, code })).sort((a, b) => b.code.length - a.code.length);
    let isBeerToText = false;

    function toggleMode() {
        isBeerToText = !isBeerToText;
        document.getElementById('left-label').classList.toggle('inactive');
        document.getElementById('right-label').classList.toggle('inactive');
        document.getElementById('input-text').value = '';
        document.getElementById('output-field').innerText = '';
    }

    function doTranslate() {
        const input = document.getElementById('input-text').value;
        const output = document.getElementById('output-field');
        if (!input) { output.innerText = ''; return; }
        if (!isBeerToText) {
            let res = '';
            for (let char of input.toUpperCase()) { res += beerMap[char] || char; }
            output.innerText = res;
        } else {
            let res = ''; let i = 0;
            while (i < input.length) {
                let found = false;
                for (let item of reverseCodes) {
                    if (input.substr(i, item.code.length) === item.code) { res += item.letter; i += item.code.length; found = true; break; }
                }
                if (!found) { res += input[i]; i++; }
            }
            output.innerText = res.toLowerCase();
        }
    }

    function clearInput() { document.getElementById('input-text').value = ''; doTranslate(); }
    function copyToClipboard() { const text = document.getElementById('output-field').innerText; if(text) navigator.clipboard.writeText(text); }

    // --- –ú–û–î–ê–õ–ö–ê –ò –°–ò–°–¢–ï–ú–ê ---
    const modal = document.getElementById('gameModal');
    const menu = document.getElementById('gameMenu');
    let activeIntervals = [];

    function openGameModal() { modal.style.display = 'flex'; backToMenu(); }
    function closeGameModal() { modal.style.display = 'none'; stopAllGames(); }
    function backToMenu() {
        stopAllGames();
        menu.style.display = 'grid';
        document.getElementById('gameTitle').innerText = '–ò–≥—Ä–æ–≤–æ–µ –ú–µ–Ω—é';
        ['forumContainer', 'clickerContainer', 'minesContainer', 'snakeContainer', 'geoContainer', 'casinoContainer'].forEach(id => {
            document.getElementById(id).style.display = 'none';
        });
    }
    function stopAllGames() { activeIntervals.forEach(clearInterval); activeIntervals = []; }

    // ============================================================
    // –ß–ê–¢
    // ============================================================
    
    const API_URL = 'https://beer-chat-worker.spiderkaras.workers.dev'; 

    let currentUser = null;
    const USERS_KEY = 'beerChatUser';
    let chatUpdateInterval = null;
    let pendingAttachments = []; 
    let pendingVoice = null;     
    let mediaRecorder = null;
    let audioChunks = [];

    function compressImage(file) {
        return new Promise((resolve) => {
            const reader = new FileReader();
            reader.readAsDataURL(file);
            reader.onload = (event) => {
                const img = new Image();
                img.src = event.target.result;
                img.onload = () => {
                    const canvas = document.createElement('canvas');
                    let width = img.width;
                    let height = img.height;
                    const maxSize = 300; 
                    if (width > height) {
                        if (width > maxSize) { height *= maxSize / width; width = maxSize; }
                    } else {
                        if (height > maxSize) { width *= maxSize / height; height = maxSize; }
                    }
                    canvas.width = width;
                    canvas.height = height;
                    const ctx = canvas.getContext('2d');
                    ctx.drawImage(img, 0, 0, width, height);
                    resolve(canvas.toDataURL('image/jpeg', 0.5));
                };
            };
        });
    }

    function fileToBase64(file) {
        return new Promise((resolve, reject) => {
            const reader = new FileReader();
            reader.readAsDataURL(file);
            reader.onload = () => resolve(reader.result);
            reader.onerror = error => reject(error);
        });
    }

    function loadCurrentUser() {
        const saved = localStorage.getItem(USERS_KEY);
        if (saved) {
            try {
                currentUser = JSON.parse(saved);
                return true;
            } catch (e) {}
        }
        return false;
    }

    function saveCurrentUser() {
        if (currentUser) localStorage.setItem(USERS_KEY, JSON.stringify(currentUser));
        else localStorage.removeItem(USERS_KEY);
    }

    function showAuthTab(tab) {
        document.querySelectorAll('.auth-tab').forEach(el => el.classList.remove('active'));
        document.querySelectorAll('.auth-form').forEach(el => el.classList.remove('active'));
        if (tab === 'register') {
            document.querySelector('.auth-tab').classList.add('active');
            document.getElementById('registerForm').classList.add('active');
        } else {
            document.querySelectorAll('.auth-tab')[1].classList.add('active');
            document.getElementById('loginForm').classList.add('active');
        }
    }

    document.getElementById('regAvatarInput').addEventListener('change', async function() {
        const f = this.files[0];
        if (!f || !f.type.startsWith('image/')) return;
        const img = document.getElementById('regAvatarPreview');
        img.style.display = 'block';
        const compressed = await compressImage(f);
        img.src = compressed;
    });

    async function doRegister() {
        const nickname = (document.getElementById('regNickname').value || '').trim();
        const password = (document.getElementById('regPassword').value || '').trim();
        const codeWord = (document.getElementById('regCodeWord').value || '').trim();
        const avatarFile = document.getElementById('regAvatarInput').files[0];
        
        if (!nickname) { alert('–í–≤–µ–¥–∏—Ç–µ –Ω–∏–∫–Ω–µ–π–º'); return; }
        if (!password) { alert('–í–≤–µ–¥–∏—Ç–µ –ø–∞—Ä–æ–ª—å'); return; }
        if (!codeWord) { alert('–í–≤–µ–¥–∏—Ç–µ –∫–æ–¥–æ–≤–æ–µ —Å–ª–æ–≤–æ'); return; }

        let avatarBase64 = '';
        if (avatarFile) {
            try {
                avatarBase64 = await compressImage(avatarFile);
            } catch(e) { console.error(e); }
        }

        const userId = Date.now();
        currentUser = { id: userId, nickname: nickname, avatarUrl: avatarBase64, guest: false };
        saveCurrentUser();
        
        document.getElementById('authScreen').style.display = 'none';
        document.getElementById('chatArea').style.display = 'flex';
        refreshChatUI();
        
        document.getElementById('regNickname').value = '';
        document.getElementById('regPassword').value = '';
        document.getElementById('regCodeWord').value = '';
    }

    async function doLogin() {
        const nickname = (document.getElementById('loginNickname').value || '').trim();
        if (!nickname) { alert('–í–≤–µ–¥–∏—Ç–µ –Ω–∏–∫'); return; }
        currentUser = { id: Date.now(), nickname: nickname, avatarUrl: '', guest: false };
        saveCurrentUser();
        document.getElementById('authScreen').style.display = 'none';
        document.getElementById('chatArea').style.display = 'flex';
        refreshChatUI();
    }

    function doLogout() {
        currentUser = null;
        saveCurrentUser();
        document.getElementById('authScreen').style.display = 'block';
        document.getElementById('chatArea').style.display = 'none';
    }

    function enterAsGuest() {
        currentUser = { guest: true, nickname: '–ì–æ—Å—Ç—å', id: null, avatarUrl: '' };
        saveCurrentUser();
        document.getElementById('authScreen').style.display = 'none';
        document.getElementById('chatArea').style.display = 'flex';
        refreshChatUI();
    }

    function refreshChatUI() {
        if (!currentUser) return;
        document.getElementById('myNickname').innerText = currentUser.nickname;
        
        const img = document.getElementById('myAvatarImg');
        if (currentUser.avatarUrl) {
            img.style.display = 'block';
            img.src = currentUser.avatarUrl;
        } else {
            img.style.display = 'none';
        }

        const guestNotice = document.getElementById('guestLimitNotice');
        if (currentUser.guest) {
            guestNotice.style.display = 'block';
            document.getElementById('guestLimitCount').innerText = '0';
        } else {
            guestNotice.style.display = 'none';
        }
    }

    async function handleFileSelect(input) {
        if (!input.files || input.files.length === 0) return;
        
        for (let file of input.files) {
            try {
                let finalData = '';
                if (file.type.startsWith('image/')) {
                    finalData = await compressImage(file);
                } else {
                    if (file.size > 1 * 1024 * 1024) {
                        alert(`–§–∞–π–ª ${file.name} —Å–ª–∏—à–∫–æ–º –±–æ–ª—å—à–æ–π!`);
                        continue;
                    }
                    finalData = await fileToBase64(file);
                }
                pendingAttachments.push({
                    name: file.name,
                    type: file.type,
                    data: finalData
                });
            } catch (e) { console.error(e); }
        }
        input.value = ''; 
        renderAttachmentsPreview();
    }

    function renderAttachmentsPreview() {
        const div = document.getElementById('attachmentsPreview');
        div.innerHTML = '';
        
        pendingAttachments.forEach((att, idx) => {
            const item = document.createElement('div');
            item.className = 'preview-item';
            item.innerHTML = `üìÑ ${att.name.substring(0, 10)}... <span class="remove-attach" onclick="removeAttachment(${idx})">‚úñ</span>`;
            div.appendChild(item);
        });

        if (pendingVoice) {
            const vItem = document.createElement('div');
            vItem.className = 'preview-item';
            vItem.innerHTML = `üé§ –ê—É–¥–∏–æ <span class="remove-attach" onclick="removeVoice()">‚úñ</span>`;
            div.appendChild(vItem);
        }
    }

    function removeAttachment(idx) { pendingAttachments.splice(idx, 1); renderAttachmentsPreview(); }
    function removeVoice() { pendingVoice = null; renderAttachmentsPreview(); }

    async function toggleVoiceRecord() {
        const btn = document.getElementById('voiceBtn');
        
        if (mediaRecorder && mediaRecorder.state === 'recording') {
            mediaRecorder.stop();
            btn.classList.remove('recording');
            btn.style.color = '#9aa0a6';
        } else {
            if (!navigator.mediaDevices) { alert('–ù–µ—Ç –¥–æ—Å—Ç—É–ø–∞ –∫ –º–∏–∫—Ä–æ'); return; }
            try {
                const stream = await navigator.mediaDevices.getUserMedia({ audio: true });
                let options = { audioBitsPerSecond: 32000 };
                try { mediaRecorder = new MediaRecorder(stream, options); } catch (e) { mediaRecorder = new MediaRecorder(stream); }
                audioChunks = [];
                mediaRecorder.ondataavailable = event => { if (event.data.size > 0) audioChunks.push(event.data); };
                mediaRecorder.onstop = async () => {
                    const type = (audioChunks[0] && audioChunks[0].type) || 'audio/webm';
                    const audioBlob = new Blob(audioChunks, { type: type });
                    if (audioBlob.size > 1024 * 1024) { alert('–ì–æ–ª–æ—Å–æ–≤–æ–µ —Å–ª–∏—à–∫–æ–º –±–æ–ª—å—à–æ–µ!'); return; }
                    try {
                        const b64 = await fileToBase64(audioBlob);
                        pendingVoice = b64;
                        renderAttachmentsPreview();
                    } catch(e) {}
                    stream.getTracks().forEach(track => track.stop());
                };
                mediaRecorder.start();
                btn.classList.add('recording');
                btn.style.color = '#ea4335';
            } catch (err) { alert('–û—à–∏–±–∫–∞ –º–∏–∫—Ä–æ: ' + err.message); }
        }
    }

    function escapeHtml(text) {
        if (!text) return "";
        const div = document.createElement('div');
        div.textContent = text;
        return div.innerHTML;
    }

    async function sendPost() {
        if (!currentUser) return;
        const text = document.getElementById('forumText').value.trim();
        if (!text && pendingAttachments.length === 0 && !pendingVoice) return;
        const btn = document.getElementById('sendPostBtn');
        btn.disabled = true;

        let safeAvatar = currentUser.avatarUrl;
        if (safeAvatar && safeAvatar.length > 50000) safeAvatar = null; 

        const payload = { 
            user: currentUser.nickname, 
            text: text,
            avatar: safeAvatar,
            attachments: pendingAttachments,
            voice: pendingVoice
        };

        const jsonStr = JSON.stringify(payload);
        if (jsonStr.length > 1 * 1024 * 1024) { 
             alert('–°–ª–∏—à–∫–æ–º –º–Ω–æ–≥–æ –¥–∞–Ω–Ω—ã—Ö!'); btn.disabled = false; return;
        }

        try {
            const response = await fetch(`${API_URL}/messages`, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: jsonStr
            });
            if (!response.ok) throw new Error('–û—à–∏–±–∫–∞ ' + response.status);

            document.getElementById('forumText').value = '';
            pendingAttachments = [];
            pendingVoice = null;
            renderAttachmentsPreview();
            await loadForumMessages();
        } catch (error) {
            alert('–û—à–∏–±–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ —Ç–æ–ª—å–∫–æ —Ç–µ–∫—Å—Ç.');
        } finally {
            btn.disabled = false;
        }
    }

    async function loadForumMessages() {
        try {
            const response = await fetch(`${API_URL}/messages`);
            if (!response.ok) throw new Error('Err');
            
            const messages = await response.json();
            const cont = document.getElementById('forumPosts');
            cont.innerHTML = "";
            
            if (!messages || messages.length === 0) {
                cont.innerHTML = '<div style="text-align:center;padding:20px;color:#9aa0a6;">–ü—É—Å—Ç–æ...</div>';
                return;
            }

            messages.forEach(msg => {
                const card = document.createElement("div");
                card.className = "post-card";
                if (currentUser && (msg.user === currentUser.nickname)) card.classList.add('own-post');

                let avatarHtml = `<div class="post-avatar">üí¨</div>`;
                if (msg.avatar) avatarHtml = `<img src="${msg.avatar}" class="post-avatar">`;

                let attachmentsHtml = '';
                if (msg.attachments) {
                    msg.attachments.forEach(att => {
                        if (att.data) {
                            if (att.type.startsWith('image/')) {
                                attachmentsHtml += `<img src="${att.data}" class="post-img" onclick="window.open(this.src)">`;
                            } else {
                                attachmentsHtml += `<a href="${att.data}" download="${att.name}" style="display:block;margin-top:5px;color:#8ab4f8;">üìé ${escapeHtml(att.name)}</a>`;
                            }
                        }
                    });
                }
                let voiceHtml = '';
                if (msg.voice) voiceHtml = `<div style="margin-top:5px;"><audio controls src="${msg.voice}" style="height:30px; width:200px;"></audio></div>`;

                card.innerHTML = `
                    <div class="post-author">${avatarHtml} <span>${escapeHtml(msg.user)}</span></div>
                    <div class="post-text">${escapeHtml(msg.text)}</div>
                    ${attachmentsHtml} ${voiceHtml}
                `;
                cont.appendChild(card);
            });
        } catch (error) {}
    }

    function openForum() {
        menu.style.display = 'none';
        document.getElementById('forumContainer').style.display = 'flex';
        document.getElementById('gameTitle').innerText = '–ß–∞—Ç';
        
        if (loadCurrentUser()) {
            document.getElementById('authScreen').style.display = 'none';
            document.getElementById('chatArea').style.display = 'flex';
            refreshChatUI();
            loadForumMessages();
            if (chatUpdateInterval) clearInterval(chatUpdateInterval);
            chatUpdateInterval = setInterval(loadForumMessages, 3000); 
            activeIntervals.push(chatUpdateInterval);
        } else {
            document.getElementById('authScreen').style.display = 'block';
            document.getElementById('chatArea').style.display = 'none';
        }
    }

    // --- BEER CLICKER ---
    let cookies = 0;
    let buildings = [
        { id: 0, name: '–ö—É—Ä—Å–æ—Ä', baseCost: 15, count: 0, cps: 0.1, icon: 'üëÜ' },
        { id: 1, name: '–ë–∞–±—É—à–∫–∞', baseCost: 100, count: 0, cps: 1, icon: 'üëµ' },
        { id: 2, name: '–•–º–µ–ª—å', baseCost: 1100, count: 0, cps: 8, icon: 'üåæ' },
        { id: 3, name: '–®–∞—Ö—Ç–∞', baseCost: 12000, count: 0, cps: 47, icon: '‚õèÔ∏è' },
        { id: 4, name: '–ó–∞–≤–æ–¥', baseCost: 130000, count: 0, cps: 260, icon: 'üè≠' },
        { id: 5, name: '–ë–∞–Ω–∫', baseCost: 1400000, count: 0, cps: 1400, icon: 'üè¶' },
        { id: 6, name: '–•—Ä–∞–º', baseCost: 20000000, count: 0, cps: 7800, icon: 'üèõÔ∏è' }
    ];

    function getBuildingCost(b) { return Math.floor(b.baseCost * Math.pow(1.15, b.count)); }

    function openClicker() {
        menu.style.display = 'none';
        document.getElementById('clickerContainer').style.display = 'flex';
        document.getElementById('gameTitle').innerText = 'Clicker';
        
        let saved = localStorage.getItem('beerClickerSave');
        if(saved) {
            let parsed = JSON.parse(saved);
            cookies = parsed.cookies;
            parsed.buildings.forEach((savedB, index) => { if(buildings[index]) buildings[index].count = savedB.count; });
        }
        renderStore();
        activeIntervals.push(setInterval(() => {
            let totalCps = buildings.reduce((sum, b) => sum + (b.count * b.cps), 0);
            cookies += totalCps / 10;
            updateClickerUI();
        }, 100));
    }

    function updateClickerUI() {
        document.getElementById('beerCount').innerText = Math.floor(cookies);
        let totalCps = buildings.reduce((sum, b) => sum + (b.count * b.cps), 0);
        document.getElementById('beerCps').innerText = '/—Å–µ–∫: ' + totalCps.toFixed(1);
        
        buildings.forEach(b => {
            let el = document.getElementById('building-' + b.id);
            if(el) {
                if(cookies >= getBuildingCost(b)) el.style.opacity = '1'; else el.style.opacity = '0.5';
            }
        });
    }

    function renderStore() {
        const store = document.getElementById('storeList');
        store.innerHTML = '';
        buildings.forEach(b => {
            const item = document.createElement('div');
            item.className = 'building-item';
            item.id = 'building-' + b.id;
            item.style.display = "flex";
            item.style.alignItems = "center";
            item.style.borderBottom = "1px solid #3c4043";
            item.innerHTML = `
                <div class="b-icon">${b.icon}</div>
                <div style="flex:1">
                    <div class="b-name">${b.name}</div>
                    <div class="b-cost" style="color:#81c995">${getBuildingCost(b)}</div>
                </div>
                <div class="b-count" style="font-size:18px; font-weight:bold; color:#5f6368">${b.count}</div>
            `;
            item.onclick = () => {
                let cost = getBuildingCost(b);
                if(cookies >= cost) { cookies -= cost; b.count++; renderStore(); updateClickerUI(); }
            };
            store.appendChild(item);
        });
    }

    function saveClicker() {
        localStorage.setItem('beerClickerSave', JSON.stringify({
            cookies: cookies,
            buildings: buildings.map(b => ({ count: b.count }))
        }));
    }

    document.getElementById('bigCookie').onclick = (e) => {
        cookies++;
        updateClickerUI();
        
        // –ê–Ω–∏–º–∞—Ü–∏—è –∫–ª–∏–∫–∞ (—É–ø—Ä–æ—â–µ–Ω–Ω–∞—è)
        const plus = document.createElement('div');
        plus.innerText = '+1';
        plus.style.position = 'absolute';
        
        // –ö–æ—Ä—Ä–µ–∫—Ü–∏—è –ø–æ–∑–∏—Ü–∏–∏ –¥–ª—è —Ç–∞—á–∞
        let cx = e.clientX; 
        let cy = e.clientY;
        // –ï—Å–ª–∏ –∫–ª–∏–∫ –Ω–µ –º—ã—à–∫–æ–π (–Ω–∞–ø—Ä —Ç–∞—á), –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –º–æ–≥—É—Ç –±—ã—Ç—å –¥—Ä—É–≥–∏–º–∏, –Ω–æ e.client —Ä–∞–±–æ—Ç–∞–µ—Ç –æ–±—ã—á–Ω–æ
        
        plus.style.left = cx + 'px';
        plus.style.top = cy - 20 + 'px';
        plus.style.color = '#fff';
        plus.style.fontWeight = 'bold';
        plus.style.zIndex = '1000';
        plus.style.pointerEvents = 'none';
        document.body.appendChild(plus);
        
        setTimeout(() => plus.remove(), 500);
    };

    // --- –°–ê–ü–ï–† ---
    function openMines() {
        menu.style.display = 'none';
        document.getElementById('minesContainer').style.display = 'flex';
        document.getElementById('gameTitle').innerText = '–°–∞–ø–µ—Ä';
        initMinesweeper();
    }
    function initMinesweeper() {
        const grid = document.getElementById('minesGrid');
        grid.innerHTML = '';
        let minesCount = 12;
        let cells = [];
        for(let i=0; i<100; i++) cells.push({ mine: false, revealed: false });
        for(let i=0; i<minesCount; i++) {
            let r = Math.floor(Math.random()*100);
            if(cells[r].mine) i--; else cells[r].mine = true;
        }
        cells.forEach((c) => {
            const cell = document.createElement('div');
            cell.className = 'mine-cell';
            cell.style.background = '#bdc1c6';
            cell.style.display = 'flex';
            cell.style.alignItems = 'center';
            cell.style.justifyContent = 'center';
            cell.style.cursor = 'pointer';
            
            cell.onclick = () => {
                if(c.mine) { 
                    cell.style.background = '#ea4335';
                    cell.innerText = 'üí£';
                    setTimeout(() => { alert('–ë–ê–ë–ê–•!'); initMinesweeper(); }, 100);
                }
                else {
                    cell.style.background = '#d1d1d1';
                    cell.innerText = '';
                }
            };
            grid.appendChild(cell);
        });
    }

    // --- –ó–ú–ï–ô–ö–ê ---
    let snakeDx = 1, snakeDy = 0;
    
    function openSnake() {
        menu.style.display = 'none';
        document.getElementById('snakeContainer').style.display = 'flex';
        document.getElementById('gameTitle').innerText = '–ó–º–µ–π–∫–∞';
        initSnakeGame();
    }
    
    function setSnakeDir(x, y) {
        if (x !== 0 && snakeDx === 0) { snakeDx = x; snakeDy = 0; }
        if (y !== 0 && snakeDy === 0) { snakeDx = 0; snakeDy = y; }
    }

    function initSnakeGame() {
        const canvas = document.getElementById('snake-canvas');
        const ctx = canvas.getContext('2d');
        // –°–±—Ä–æ—Å –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è
        snakeDx = 1; snakeDy = 0;
        
        let score = 0;
        let snake = [{x: 10, y: 10}];
        let food = {x: 15, y: 15};
        
        document.onkeydown = (e) => {
            if(e.key === 'ArrowUp') setSnakeDir(0, -1);
            if(e.key === 'ArrowDown') setSnakeDir(0, 1);
            if(e.key === 'ArrowLeft') setSnakeDir(-1, 0);
            if(e.key === 'ArrowRight') setSnakeDir(1, 0);
        };

        activeIntervals.push(setInterval(() => {
            let head = {x: snake[0].x + snakeDx, y: snake[0].y + snakeDy};
            // –ü—Ä–æ–≤–µ—Ä–∫–∞ –≥—Ä–∞–Ω–∏—Ü
            if(head.x < 0 || head.x >= 20 || head.y < 0 || head.y >= 20) { 
                alert('–°—á–µ—Ç: ' + score); backToMenu(); return; 
            }
            // –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ö–≤–æ—Å—Ç–∞
            for(let part of snake) {
                if(part.x === head.x && part.y === head.y) { alert('–°—á–µ—Ç: ' + score); backToMenu(); return; }
            }

            snake.unshift(head);
            if(head.x === food.x && head.y === food.y) {
                score++; document.getElementById('snakeScore').innerText = '–°—á–µ—Ç: ' + score;
                food = {x: Math.floor(Math.random()*20), y: Math.floor(Math.random()*20)};
            } else snake.pop();
            
            ctx.fillStyle = '#000'; ctx.fillRect(0,0,400,400);
            ctx.fillStyle = '#ea4335'; ctx.fillRect(food.x*20, food.y*20, 18, 18);
            ctx.fillStyle = '#81c995';
            snake.forEach(p => ctx.fillRect(p.x*20, p.y*20, 18, 18));
        }, 150));
    }

    // --- –§–õ–ê–ì–ò ---
    const flagData = [
        { f: 'üá∑üá∫', n: '–†–æ—Å—Å–∏—è' }, { f: 'üá∫üá∏', n: '–°–®–ê' }, { f: 'üá©üá™', n: '–ì–µ—Ä–º–∞–Ω–∏—è' }, { f: 'üá´üá∑', n: '–§—Ä–∞–Ω—Ü–∏—è' },
        { f: 'üáØüáµ', n: '–Ø–ø–æ–Ω–∏—è' }, { f: 'üá®üá≥', n: '–ö–∏—Ç–∞–π' }, { f: 'üá¨üáß', n: '–í–µ–ª–∏–∫–æ–±—Ä–∏—Ç–∞–Ω–∏—è' }, { f: 'üáßüá∑', n: '–ë—Ä–∞–∑–∏–ª–∏—è' },
        { f: 'üáÆüáπ', n: '–ò—Ç–∞–ª–∏—è' }, { f: 'üá∞üá∑', n: '–ö–æ—Ä–µ—è' }, { f: 'üá™üá∏', n: '–ò—Å–ø–∞–Ω–∏—è' }, { f: 'üá∞üáø', n: '–ö–∞–∑–∞—Ö—Å—Ç–∞–Ω' }
    ];
    let geoScore = 0;
    function openGeo() {
        menu.style.display = 'none';
        document.getElementById('geoContainer').style.display = 'flex';
        document.getElementById('gameTitle').innerText = '–§–ª–∞–≥–∏';
        nextFlag();
    }
    function nextFlag() {
        const correct = flagData[Math.floor(Math.random()*flagData.length)];
        document.getElementById('geoFlag').innerText = correct.f;
        const opts = document.getElementById('geoOptions');
        opts.innerHTML = '';
        opts.style.display = 'grid';
        opts.style.gap = '10px';
        
        let options = [correct.n];
        while(options.length < 4) {
            let r = flagData[Math.floor(Math.random()*flagData.length)].n;
            if(!options.includes(r)) options.push(r);
        }
        options.sort(() => Math.random() - 0.5).forEach(o => {
            const b = document.createElement('button');
            b.className = 'geo-btn';
            b.style.background = '#303134';
            b.style.color = '#fff';
            b.style.border = '1px solid #3c4043';
            b.style.borderRadius = '8px';
            b.innerText = o;
            b.onclick = () => {
                if(o === correct.n) { geoScore++; alert('–í–µ—Ä–Ω–æ!'); }
                else { geoScore = 0; alert('–û—à–∏–±–∫–∞! –≠—Ç–æ: ' + correct.n); }
                document.getElementById('geoScoreDisplay').innerText = '–°—á–µ—Ç: ' + geoScore;
                nextFlag();
            };
            opts.appendChild(b);
        });
    }

    // --- –ö–ê–ó–ò–ù–û ---
    let casinoBalance = 10;
    function openCasino() {
        menu.style.display = 'none';
        document.getElementById('casinoContainer').style.display = 'flex';
        document.getElementById('gameTitle').innerText = '–ö–∞–∑–∏–Ω–æ';
        updateCasinoUI();
    }
    function updateCasinoUI() { document.getElementById('casinoBalance').innerText = '$' + casinoBalance; }
    function adjustBet(mult) {
        let bet = parseInt(document.getElementById('casinoBet').value);
        document.getElementById('casinoBet').value = Math.floor(bet * mult);
    }
    function playCasino() {
        let bet = parseInt(document.getElementById('casinoBet').value);
        if(isNaN(bet) || bet <= 0 || bet > casinoBalance) { alert('–ù–µ–≤–µ—Ä–Ω–∞—è —Å—Ç–∞–≤–∫–∞!'); return; }
        const msg = document.getElementById('casinoMsg');
        if(Math.random() < 0.45) {
            casinoBalance += bet;
            msg.innerText = '–í–´–ò–ì–†–ê–õ +$' + bet; msg.style.color = '#81c995';
        } else {
            casinoBalance -= bet;
            msg.innerText = '–ü–†–û–ò–ì–†–ê–õ -$' + bet; msg.style.color = '#ea4335';
        }
        updateCasinoUI();
        if(casinoBalance <= 0) { alert('–í—ã –≤—Å–µ –ø—Ä–æ–ø–∏–ª–∏! –î–µ—Ä–∂–∏ $10.'); casinoBalance = 10; updateCasinoUI(); }
    }
</script>
</body>
</html>
