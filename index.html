<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Beer Translate & Games MEGA ULTIMATE</title>
    <style>
        /* --- –û–°–ù–û–í–ù–´–ï –°–¢–ò–õ–ò --- */
        body { background-color: #121316; color: #e8eaed; font-family: 'Segoe UI', sans-serif; display: flex; flex-direction: column; align-items: center; justify-content: center; min-height: 100vh; margin: 0; overflow: hidden; user-select: none; }
        .title-container { margin-bottom: 20px; display: flex; align-items: baseline; gap: 10px; z-index: 20; }
        h1 { font-weight: 400; font-size: 32px; color: #bdc1c6; margin: 0; }
        .author-tag { font-size: 14px; color: #5f6368; opacity: 0.7; }

        .translator-container { background-color: #1e1f21; border: 1px solid #3c4043; border-radius: 12px; width: 95%; max-width: 1100px; display: flex; flex-direction: column; box-shadow: 0 10px 30px rgba(0,0,0,0.5); position: relative; z-index: 10; }
        .header-tabs { display: flex; align-items: center; padding: 0 15px; border-bottom: 1px solid #3c4043; height: 55px; }
        .tab { color: #8ab4f8; font-size: 14px; font-weight: 500; border-bottom: 2px solid #8ab4f8; height: 100%; display: flex; align-items: center; padding: 0 10px; cursor: pointer; }
        .tab.inactive { border-bottom: 2px solid transparent; color: #9aa0a6; }
        .swap-icon { margin: 0 15px; color: #9aa0a6; cursor: pointer; font-size: 24px; }
        .right-tabs { margin-left: auto; display: flex; gap: 10px; }
        .action-tab { color: #9aa0a6; font-size: 13px; text-transform: uppercase; font-weight: bold; cursor: pointer; padding: 8px 10px; transition: 0.2s; }
        .action-tab:hover { color: #8ab4f8; }

        .main-panels { display: flex; flex-wrap: wrap; }
        .panel { flex: 1; min-width: 300px; min-height: 250px; padding: 20px; position: relative; display: flex; flex-direction: column; background: #1e1f21; box-sizing: border-box; }
        .input-panel { border-right: 1px solid #3c4043; }
        textarea { width: 100%; height: 100%; background: transparent; border: none; color: #fff; font-size: 20px; resize: none; outline: none; font-family: inherit; }
        #output-field { font-size: 20px; color: #bdc1c6; word-break: break-all; white-space: pre-wrap; flex-grow: 1; }

        /* –ò–ì–†–û–í–û–ï –û–ö–ù–û */
        .modal-overlay { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.9); z-index: 5000; justify-content: center; align-items: center; }
        .game-window { background: #1e1f21; border: 1px solid #3c4043; border-radius: 12px; width: 850px; max-width: 95%; height: 650px; max-height: 90vh; overflow: hidden; display: flex; flex-direction: column; }
        .game-header { padding: 15px; border-bottom: 1px solid #3c4043; display: flex; justify-content: space-between; align-items: center; }
        .game-menu { padding: 20px; display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 15px; overflow-y: auto; }
        .game-btn { background: #303134; color: #e8eaed; border: 1px solid #3c4043; padding: 20px; border-radius: 8px; cursor: pointer; font-weight: bold; transition: 0.2s; }
        .game-btn:hover { border-color: #8ab4f8; color: #8ab4f8; }
        .game-content { display: none; flex-direction: column; height: 100%; overflow: hidden; position: relative; }

        /* –ß–ê–¢ –°–¢–ò–õ–ò */
        .forum-posts { flex: 1; overflow-y: auto; padding: 15px; display: flex; flex-direction: column; gap: 10px; }
        .post-card { background: #303134; padding: 12px; border-radius: 8px; max-width: 85%; align-self: flex-start; border-left: 3px solid #8ab4f8; }
        .post-author { color: #8ab4f8; font-weight: bold; font-size: 12px; margin-bottom: 5px; }
        .post-img { max-width: 100%; max-height: 300px; border-radius: 6px; margin-top: 8px; display: block; border: 1px solid #444; }
        .forum-input-area { padding: 15px; border-top: 1px solid #3c4043; display: flex; gap: 10px; background: #202124; }
        .forum-input-area input { background: #303134; border: 1px solid #5f6368; color: #fff; padding: 10px; border-radius: 4px; width: 100px; }
        .forum-input-area textarea { flex: 1; background: #303134; border: 1px solid #5f6368; color: #fff; padding: 10px; border-radius: 4px; resize: none; height: 40px; font-size: 14px; }

        /* –û–°–¢–ê–õ–¨–ù–´–ï –ò–ì–†–´ */
        .casino-panel { text-align: center; padding: 40px; }
        .clicker-left { flex: 1; display: flex; flex-direction: column; align-items: center; justify-content: center; background: #1e1f21; }
        .big-beer { width: 150px; cursor: pointer; transition: 0.1s; }
        .big-beer:active { transform: scale(0.9); }
    </style>
</head>
<body>

    <div class="title-container" id="title-block">
        <h1>Beer Translate & Games</h1>
        <span class="author-tag">MEGA Edition</span>
    </div>

    <div class="translator-container" id="main-block">
        <div class="header-tabs">
            <div class="tab" id="left-label">–¢–µ–∫—Å—Ç</div>
            <div class="swap-icon" onclick="toggleMode()">‚áÑ</div>
            <div class="tab inactive" id="right-label">–ü–∏–≤–Ω–æ–π —è–∑—ã–∫</div>
            <div class="right-tabs">
                <div class="action-tab" onclick="openGameModal()">–ò–ì–†–´ / –ß–ê–¢</div>
                <div class="action-tab" onclick="startGravity()">–ì–†–ê–í–ò–¢–ê–¶–ò–Ø</div>
            </div>
        </div>
        <div class="main-panels">
            <div class="panel input-panel">
                <textarea id="input-text" placeholder="–ü–∏—à–∏ —Å—é–¥–∞..." oninput="doTranslate()"></textarea>
            </div>
            <div class="panel">
                <div id="output-field"></div>
            </div>
        </div>
    </div>

    <div class="modal-overlay" id="gameModal">
        <div class="game-window">
            <div class="game-header">
                <span id="gameTitle">Beer Arcade</span>
                <span class="close-game" onclick="closeGameModal()">‚úï</span>
            </div>
            
            <div class="game-menu" id="gameMenu">
                <button class="game-btn" onclick="showGame('forumContainer', '–ß–∞—Ç')">üí¨ –ñ–ò–í–û–ô –ß–ê–¢</button>
                <button class="game-btn" onclick="showGame('clickerContainer', 'Beer Clicker')">üç∫ –ö–õ–ò–ö–ï–†</button>
                <button class="game-btn" onclick="showGame('casinoContainer', '–ö–∞–∑–∏–Ω–æ')">üé≤ –ö–ê–ó–ò–ù–û</button>
                <button class="game-btn" onclick="alert('–ó–º–µ–π–∫–∞ –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ')">üêç –ó–ú–ï–ô–ö–ê</button>
            </div>

            <div id="forumContainer" class="game-content">
                <button class="back-btn" onclick="backToMenu()" style="background:none; border:none; color:#9aa0a6; padding:10px; cursor:pointer;">‚Üê –ù–∞–∑–∞–¥</button>
                <div class="forum-posts" id="forumPosts"></div>
                <div class="forum-input-area">
                    <input id="forumName" placeholder="–ò–º—è" maxlength="15" value="–ê–Ω–æ–Ω–∏–º">
                    <textarea id="forumText" placeholder="–°—Å—ã–ª–∫–∞ (Discord/Giphy/PNG) –∏–ª–∏ —Ç–µ–∫—Å—Ç..."></textarea>
                    <button class="game-btn" style="padding: 10px;" onclick="sendPost()">‚û§</button>
                </div>
            </div>

            <div id="clickerContainer" class="game-content">
                <div class="clicker-left">
                    <button class="back-btn" onclick="backToMenu()">‚Üê –ù–∞–∑–∞–¥</button>
                    <div id="beerCount" style="font-size:30px;">0 –ü–∏–≤–∞</div>
                    <img src="https://img.icons8.com/color/480/beer-glass.png" class="big-beer" onclick="beers++; updateClicker()">
                </div>
            </div>

            <div id="casinoContainer" class="game-content">
                <button class="back-btn" onclick="backToMenu()">‚Üê –ù–∞–∑–∞–¥</button>
                <div class="casino-panel">
                    <div id="casBal" style="font-size:40px; color:#81c995;">$100</div>
                    <button class="game-btn" onclick="playCasino()">–†–ò–°–ö–ù–£–¢–¨ $10</button>
                </div>
            </div>
        </div>
    </div>

    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>

    <script>
        /* –ü–ï–†–ï–í–û–î–ß–ò–ö */
        const beerMap = {'–ê': '–≤–ª–¥–∞–æ–ª–¥—Ü—Ç3894', '–ë': '78–µ–º9—Ç4325243895—Ç–º72', '–í': '–∞—Ç–¥–ª–∂–∏—ã—Ñ–≤–µ–∏0653'};
        function doTranslate() {
            let input = document.getElementById('input-text').value.toUpperCase();
            let out = ""; for(let char of input) out += beerMap[char] || char;
            document.getElementById('output-field').innerText = out;
        }

        /* FIREBASE */
        const firebaseConfig = {
            apiKey: "AIzaSyCesMs7AFeefzwVLhJfKyA3_QROoRnnONo",
            authDomain: "beerlanguage-1337.firebaseapp.com",
            projectId: "beerlanguage-1337",
            storageBucket: "beerlanguage-1337.firebasestorage.app",
            messagingSenderId: "18636363390",
            appId: "1:18636363390:web:aa02dfd1ce7e53f6d0aa2f"
        };
        firebase.initializeApp(firebaseConfig);
        const db = firebase.firestore();

        // –£–õ–£–ß–®–ï–ù–ù–ê–Ø –ü–†–û–í–ï–†–ö–ê –ú–ï–î–ò–ê (DISCORD FRIENDLY)
        function isMedia(url) {
            if (!url.startsWith('http')) return false;
            // –£–±–∏—Ä–∞–µ–º –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –ø–æ—Å–ª–µ ?, —á—Ç–æ–±—ã –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ
            const cleanUrl = url.split('?')[0].toLowerCase();
            const isImg = /\.(jpg|jpeg|png|webp|gif|svg)$/.test(cleanUrl);
            const isDiscord = url.includes('cdn.discordapp.com') || url.includes('media.discordapp.net');
            return isImg || isDiscord;
        }

        async function sendPost() {
            let n = document.getElementById('forumName').value || "–ê–Ω–æ–Ω–∏–º";
            let t = document.getElementById('forumText').value.trim();
            if(!t) return;
            await db.collection("posts").add({ name: n, text: t, time: Date.now() });
            document.getElementById('forumText').value = "";
        }

        document.getElementById('forumText').onkeydown = e => { if(e.key==='Enter' && !e.shiftKey) { e.preventDefault(); sendPost(); } };

        db.collection("posts").orderBy("time","asc").onSnapshot(snap => {
            let cont = document.getElementById('forumPosts'); cont.innerHTML = "";
            snap.forEach(doc => {
                let p = doc.data();
                let content = isMedia(p.text) 
                    ? `<img src="${p.text}" class="post-img" onerror="this.onerror=null; this.src='https://placehold.co/200?text=–û—à–∏–±–∫–∞+–∑–∞–≥—Ä—É–∑–∫–∏';">` 
                    : `<div>${escapeHtml(p.text)}</div>`;
                
                cont.innerHTML += `<div class="post-card">
                    <div class="post-author">${escapeHtml(p.name)}</div>
                    ${content}
                </div>`;
            });
            cont.scrollTop = cont.scrollHeight;
        });

        /* –°–ò–°–¢–ï–ú–ê –û–ö–û–ù */
        function openGameModal() { document.getElementById('gameModal').style.display='flex'; }
        function closeGameModal() { document.getElementById('gameModal').style.display='none'; }
        function backToMenu() {
            document.getElementById('gameMenu').style.display='grid';
            document.querySelectorAll('.game-content').forEach(c => c.style.display='none');
        }
        function showGame(id, title) {
            document.getElementById('gameMenu').style.display='none';
            document.getElementById(id).style.display='flex';
            document.getElementById('gameTitle').innerText = title;
        }

        function escapeHtml(t) { const d = document.createElement('div'); d.textContent = t; return d.innerHTML; }
        
        /* –ö–õ–ò–ö–ï–† & –ö–ê–ó–ò–ù–û –ó–ê–ì–õ–£–®–ö–ò */
        let beers = 0; function updateClicker() { document.getElementById('beerCount').innerText = beers + " –ü–∏–≤–∞"; }
        let bal = 100; function playCasino() { if(bal<10)return; bal-=10; if(Math.random()>0.7) bal+=50; document.getElementById('casBal').innerText = "$"+bal; }

        /* –ì–†–ê–í–ò–¢–ê–¶–ò–Ø */
        function startGravity() { 
            const main = document.getElementById('main-block');
            main.style.transition = "transform 2s ease-in, opacity 2s";
            main.style.transform = "translateY(1000px) rotate(20deg)";
            main.style.opacity = "0";
            setTimeout(() => { alert("–í—Å—ë —É–ø–∞–ª–æ. –û–±–Ω–æ–≤–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—É!"); }, 2000);
        }
    </script>
</body>
</html>
