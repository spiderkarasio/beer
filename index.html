<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Beer Translate & Games Ultimate</title>
    <script type="text/javascript">
        var isMobile = /iPhone|iPad|iPod|Android|BlackBerry|Opera Mini|IEMobile/i.test(navigator.userAgent);
    </script>
    <style>
        /* --- –û–°–ù–û–í–ù–´–ï –°–¢–ò–õ–ò --- */
        body { background-color: #121316; color: #e8eaed; font-family: 'Segoe UI', sans-serif; display: flex; flex-direction: column; align-items: center; justify-content: center; min-height: 100vh; margin: 0; overflow: hidden; user-select: none; -webkit-user-select: none; touch-action: none; }
        .title-container { margin-bottom: 20px; display: flex; align-items: baseline; gap: 10px; cursor: grab; z-index: 20; }
        h1 { font-weight: 400; font-size: 32px; color: #bdc1c6; margin: 0; pointer-events: none; }
        .secret-link { color: inherit; text-decoration: none; cursor: pointer; pointer-events: auto; transition: color 0.2s; }
        .secret-link:hover { color: #8ab4f8; }
        .author-tag { font-size: 14px; color: #5f6368; font-weight: 500; opacity: 0.7; pointer-events: none; }
        .s-link { color: inherit; text-decoration: none; pointer-events: auto; transition: color 0.3s, text-shadow 0.3s; }
        .s-link:hover { color: #2979ff; text-shadow: 0 0 10px rgba(41, 121, 255, 0.6); }

        .translator-container { background-color: #1e1f21; border: 1px solid #3c4043; border-radius: 12px; width: 95%; max-width: 1100px; display: flex; flex-direction: column; box-shadow: 0 10px 30px rgba(0,0,0,0.5); position: relative; z-index: 10; touch-action: none; }
        .header-tabs { display: flex; align-items: center; padding: 0 15px; border-bottom: 1px solid #3c4043; height: 55px; cursor: grab; flex-shrink: 0; }
        .tab { color: #8ab4f8; font-size: 14px; font-weight: 500; border-bottom: 2px solid #8ab4f8; height: 100%; display: flex; align-items: center; padding: 0 10px; cursor: pointer; white-space: nowrap; }
        .tab.inactive { border-bottom: 2px solid transparent; color: #9aa0a6; }
        .swap-icon { margin: 0 15px; color: #9aa0a6; cursor: pointer; font-size: 24px; }
        .right-tabs { margin-left: auto; display: flex; gap: 5px; }
        .action-tab { color: #9aa0a6; font-size: 13px; text-transform: uppercase; font-weight: bold; cursor: pointer; padding: 8px 10px; border-radius: 4px; transition: background 0.2s; white-space: nowrap; }
        .action-tab:hover { color: #fff; background: rgba(255,255,255,0.05); }
        .game-tab { color: #8ab4f8; }

        .main-panels { display: flex; flex-wrap: wrap; height: 100%; }
        .panel { flex: 1; min-width: 300px; min-height: 250px; padding: 20px; position: relative; display: flex; flex-direction: column; background: #1e1f21; box-sizing: border-box; }
        .input-panel { border-right: 1px solid #3c4043; }
        textarea { width: 100%; height: 100%; background: transparent; border: none; color: #fff; font-size: 20px; resize: none; outline: none; font-family: inherit; }
        #output-field { font-size: 20px; color: #bdc1c6; word-break: break-all; white-space: pre-wrap; flex-grow: 1; margin-bottom: 40px; min-height: 1.2em; overflow-y: auto; }
        .clear-btn { position: absolute; top: 15px; right: 15px; color: #9aa0a6; cursor: pointer; font-size: 22px; padding: 5px; z-index: 5; }
        .panel-footer { position: absolute; bottom: 12px; right: 12px; display: flex; align-items: center; gap: 12px; }
        .old-version-btn { color: #8ab4f8; text-decoration: none; font-size: 13px; font-weight: 500; padding: 6px 14px; border: 1px solid #3c4043; border-radius: 20px; transition: all 0.2s; }
        .old-version-btn:hover { background: rgba(138, 180, 248, 0.08); border-color: #8ab4f8; }
        .copy-btn { background: transparent; border: none; color: #9aa0a6; cursor: pointer; padding: 8px; border-radius: 50%; transition: all 0.2s; display: flex; align-items: center; justify-content: center; }
        .copy-btn svg { width: 24px; height: 24px; fill: currentColor; }

        /* –ò–ì–†–û–í–û–ï –û–ö–ù–û */
        .modal-overlay { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.85); z-index: 5000; justify-content: center; align-items: center; }
        .game-window { background: #1e1f21; border: 1px solid #3c4043; border-radius: 12px; width: 800px; max-width: 95%; max-height: 90vh; overflow: hidden; display: flex; flex-direction: column; box-shadow: 0 0 50px rgba(0,0,0,0.8); }
        .game-header { padding: 15px; border-bottom: 1px solid #3c4043; display: flex; justify-content: space-between; align-items: center; flex-shrink: 0; }
        .game-menu { padding: 20px; display: grid; grid-template-columns: 1fr 1fr; gap: 10px; overflow-y: auto; }
        @media (min-width: 600px) { .game-menu { grid-template-columns: 1fr 1fr 1fr; } }

        .game-btn { background: #303134; color: #e8eaed; border: none; padding: 15px; border-radius: 8px; cursor: pointer; font-weight: bold; transition: all 0.2s; font-size: 16px; display: flex; align-items: center; justify-content: center; gap: 8px; }
        .game-btn:hover, .game-btn:active { background: #8ab4f8; color: #000; }
        .close-game { cursor: pointer; color: #9aa0a6; font-size: 24px; padding: 5px; }
        .game-content { padding: 20px; display: none; flex-direction: column; align-items: center; overflow-y: auto; height: 100%; }
        .back-btn { margin-bottom: 15px; align-self: flex-start; background: none; border: none; color: #9aa0a6; cursor: pointer; font-size: 16px; padding: 10px 0; }

        /* –ö–ê–ó–ò–ù–û */
        .casino-panel { text-align: center; width: 100%; max-width: 400px; background: #202124; padding: 30px; border-radius: 12px; border: 1px solid #3c4043; }
        .balance-display { font-size: 36px; color: #81c995; font-weight: bold; margin-bottom: 20px; font-family: monospace; }
        .bet-input { background: #303134; border: 1px solid #5f6368; color: #fff; padding: 15px; font-size: 20px; border-radius: 8px; width: 100%; box-sizing: border-box; text-align: center; margin-bottom: 10px; }
        .casino-btn { width: 100%; padding: 15px; background: #e37400; color: #fff; font-size: 20px; border: none; border-radius: 8px; font-weight: bold; cursor: pointer; transition: 0.2s; }
        .casino-btn:hover { background: #f29900; }
        .casino-msg { margin-top: 15px; min-height: 24px; font-weight: bold; }

        /* –ö–õ–ò–ö–ï–† */
        #clickerContainer { flex-direction: row; align-items: stretch; padding: 0; overflow: hidden; }
        .clicker-left { flex: 1; display: flex; flex-direction: column; align-items: center; justify-content: center; border-right: 1px solid #3c4043; background: radial-gradient(circle at center, #303134 0%, #1e1f21 70%); position: relative; padding: 20px; }
        .clicker-right { flex: 1; min-width: 300px; background: #202124; overflow-y: auto; border-left: 1px solid #3c4043; display: flex; flex-direction: column; }
        .big-cookie { width: 200px; height: 200px; background: url('https://img.icons8.com/color/480/beer-glass.png') no-repeat center/contain; cursor: pointer; transition: transform 0.1s; z-index: 5; }
        .big-cookie:active { transform: scale(0.95); }
        .score-box { text-align: center; margin-bottom: 30px; z-index: 5; }
        .cookies-count { font-size: 32px; font-weight: bold; color: #fff; }
        .cps-display { font-size: 14px; color: #9aa0a6; }
        .store-header { padding: 15px; text-align: center; font-weight: bold; background: #303134; border-bottom: 1px solid #3c4043; }
        .building-item { display: flex; align-items: center; padding: 12px; border-bottom: 1px solid #3c4043; cursor: pointer; transition: 0.2s; user-select: none; }
        .building-item:hover { background: rgba(255,255,255,0.05); }
        .building-item.locked { opacity: 0.5; pointer-events: none; filter: grayscale(1); }
        .b-icon { font-size: 24px; width: 40px; text-align: center; }
        .b-info { flex: 1; }
        .b-name { font-weight: bold; font-size: 14px; }
        .b-cost { font-size: 12px; color: #81c995; }
        .b-count { font-size: 24px; color: #5f6368; font-weight: bold; padding-left: 10px; }
        .click-text { position: absolute; color: #fff; font-weight: bold; font-size: 20px; pointer-events: none; animation: floatUp 1s forwards; text-shadow: 0 2px 4px rgba(0,0,0,0.5); }
        @keyframes floatUp { 0% { opacity: 1; transform: translateY(0); } 100% { opacity: 0; transform: translateY(-50px); } }

        /* –§–û–†–£–ú */
        #forumContainer { padding: 0; display: none; flex-direction: column; height: 100%; }
        .forum-input-area { padding: 15px; background: #202124; border-top: 1px solid #3c4043; display: flex; gap: 10px; flex-shrink: 0; }
        .forum-input-area input { background: #303134; border: 1px solid #5f6368; color: #fff; padding: 10px; border-radius: 4px; width: 100px; outline:none; }
        .forum-input-area textarea { flex: 1; height: 40px; padding: 10px; border: 1px solid #5f6368; border-radius: 4px; background: #303134; color:#fff; font-size: 14px; resize:none; outline:none; font-family:inherit; }
        .forum-btn { background: #8ab4f8; border: none; padding: 0 20px; border-radius: 4px; font-weight: bold; cursor: pointer; color: #000; }
        .forum-posts { flex: 1; overflow-y: auto; padding: 15px; display: flex; flex-direction: column; gap: 10px; scroll-behavior: smooth; }
        .post-card { background: #303134; padding: 10px; border-radius: 8px; font-size: 14px; box-shadow: 0 2px 5px rgba(0,0,0,0.2); }
        .post-author { color: #8ab4f8; font-weight: bold; margin-bottom: 4px; font-size: 12px; display: flex; justify-content: space-between; }
        .post-text { color: #e8eaed; white-space: pre-wrap; word-wrap: break-word; }

        /* –ê–î–ê–ü–¢–ò–í–ù–û–°–¢–¨ */
        @media (max-width: 768px) {
            h1 { font-size: 24px; }
            .translator-container { width: 98%; max-height: 85vh; }
            .main-panels { flex-direction: column; }
            .input-panel { border-right: none; border-bottom: 1px solid #3c4043; min-height: 150px; }
            #clickerContainer { flex-direction: column; overflow-y: auto; }
            .clicker-left { min-height: 250px; border-right: none; border-bottom: 1px solid #3c4043; }
        }
        
        /* –°–¢–ò–õ–ò –î–õ–Ø –ò–ì–† */
        #snake-canvas { background: #000; border: 2px solid #3c4043; max-width: 100%; touch-action: none; }
        .mines-grid { display: grid; gap: 2px; background: #3c4043; border: 2px solid #3c4043; margin-top: 10px; touch-action: manipulation; }
        .mine-cell { width: 30px; height: 30px; background: #bdc1c6; display: flex; align-items: center; justify-content: center; font-weight: bold; cursor: pointer; color: #000; user-select: none; -webkit-touch-callout: none; }
        .mine-cell.revealed { background: #303134; color: #fff; cursor: default; }
        .mine-cell.boom { background: #f44336; }
        .mine-cell.flagged { color: #f44336; }
        .geo-flag-container { margin: 20px 0; min-height: 120px; display: flex; align-items: center; justify-content: center; }
        .geo-flag-img { height: 120px; max-width: 100%; border-radius: 8px; border: 1px solid #3c4043; box-shadow: 0 4px 10px rgba(0,0,0,0.3); }
        .geo-options { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; width: 100%; }
    </style>
</head>
<body>

    <div class="title-container" id="title-block">
        <h1>Beer Translate & Games</h1>
        <span class="author-tag">Ultimate Edition</span>
    </div>

    <div class="translator-container" id="main-block">
        <div class="header-tabs">
            <div class="tab" id="left-label">–¢–µ–∫—Å—Ç</div>
            <div class="swap-icon" onclick="toggleMode()">‚áÑ</div>
            <div class="tab inactive" id="right-label">–ü–∏–≤–Ω–æ–π —è–∑—ã–∫</div>
            <div class="right-tabs">
                <div class="action-tab game-tab" onclick="openGameModal()">–ú–µ–Ω—é / –ò–≥—Ä—ã</div>
                <div class="action-tab" onclick="startGravity()">–ì—Ä–∞–≤–∏—Ç–∞—Ü–∏—è</div>
            </div>
        </div>
        <div class="main-panels">
            <div class="panel input-panel">
                <div class="clear-btn" onclick="clearAll()">‚úï</div>
                <textarea id="input-text" placeholder="–í–≤–µ–¥–∏—Ç–µ —Ç–µ–∫—Å—Ç..." oninput="doTranslate()"></textarea>
            </div>
            <div class="panel">
                <div id="output-field"></div>
                <div class="panel-footer">
                    <button class="copy-btn" id="copy-btn" onclick="copyResult()">
                        <svg id="copy-icon" viewBox="0 0 24 24"><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"/></svg>
                    </button>
                </div>
            </div>
        </div>
    </div>

    <div class="modal-overlay" id="gameModal">
        <div class="game-window">
            <div class="game-header">
                <span id="gameTitle" style="font-weight:bold; color:#bdc1c6">–ú–µ–Ω—é</span>
                <div class="close-game" onclick="closeGameModal()">‚úï</div>
            </div>
            
            <div class="game-menu" id="gameMenu">
                <button class="game-btn" onclick="initForum()">üí¨ –ñ–ò–í–û–ô –ß–ê–¢</button>
                <button class="game-btn" onclick="initMinesweeper()">üí£ –°–∞–ø–µ—Ä</button>
                <button class="game-btn" onclick="initSnake()">üêç –ó–º–µ–π–∫–∞</button>
                <button class="game-btn" onclick="initGeo()">üåç –§–ª–∞–≥–∏</button>
                <button class="game-btn" style="border: 1px solid #e37400; color: #f29900;" onclick="initCasino()">üé≤ –ö–∞–∑–∏–Ω–æ</button>
                <button class="game-btn" style="border: 1px solid #8ab4f8; color: #8ab4f8;" onclick="initClicker()">üç∫ Beer Clicker</button>
            </div>

            <div class="game-content" id="snakeContainer">
                <button class="back-btn" onclick="backToMenu()">‚Üê –ù–∞–∑–∞–¥</button>
                <canvas id="snake-canvas" width="400" height="300"></canvas>
            </div>
            <div class="game-content" id="minesContainer">
                <button class="back-btn" onclick="backToMenu()">‚Üê –ù–∞–∑–∞–¥</button>
                <div style="color:#5f6368; font-size:12px; margin-bottom: 5px;">–ü–ö–ú –∏–ª–∏ –î–æ–ª–≥–æ–µ –Ω–∞–∂–∞—Ç–∏–µ - –§–ª–∞–≥</div>
                <div class="mines-grid" id="minesGrid"></div>
            </div>
            <div class="game-content" id="geoContainer">
                <button class="back-btn" onclick="backToMenu()">‚Üê –ù–∞–∑–∞–¥</button>
                <div id="geoScore" style="color:#8ab4f8; margin-bottom:10px; font-weight: bold;">–°—á–µ—Ç: 0</div>
                <div class="geo-flag-container" id="geoFlag"></div>
                <div class="geo-options" id="geoOptions"></div>
            </div>
            
            <div class="game-content" id="casinoContainer">
                <button class="back-btn" onclick="backToMenu()">‚Üê –ù–∞–∑–∞–¥</button>
                <div class="casino-panel">
                    <div style="color: #9aa0a6; margin-bottom: 5px;">–í–∞—à –±–∞–ª–∞–Ω—Å</div>
                    <div class="balance-display" id="casinoBalance">$10</div>
                    <input type="number" id="casinoBet" class="bet-input" placeholder="–°—Ç–∞–≤–∫–∞" min="1">
                    <button class="casino-btn" onclick="playCasino()">–°–î–ï–õ–ê–¢–¨ –°–¢–ê–í–ö–£</button>
                    <div class="casino-msg" id="casinoMsg">–®–∞–Ω—Å 30% –≤—ã–∏–≥—Ä–∞—Ç—å 2x</div>
                </div>
            </div>
            
            <div id="clickerContainer" class="game-content" style="display: none; height: 100%; width: 100%; box-sizing: border-box;">
                <div class="clicker-left">
                    <button class="back-btn" style="position: absolute; top: 10px; left: 10px;" onclick="backToMenu(); saveClicker();">‚Üê –í—ã—Ö–æ–¥</button>
                    <div class="score-box">
                        <div class="cookies-count" id="beerCount">0 –ü–∏–≤–∞</div>
                        <div class="cps-display" id="beerCps">–≤ —Å–µ–∫—É–Ω–¥—É: 0</div>
                    </div>
                    <div class="big-cookie" id="bigCookie"></div>
                </div>
                <div class="clicker-right">
                    <div class="store-header">–ú–∞–≥–∞–∑–∏–Ω</div>
                    <div id="storeList"></div>
                </div>
            </div>

            <div id="forumContainer">
                <div style="padding: 10px 15px; border-bottom: 1px solid #3c4043; display: flex; align-items: center; justify-content: space-between;">
                    <button class="back-btn" style="margin: 0; padding: 0;" onclick="backToMenu()">‚Üê –ù–∞–∑–∞–¥</button>
                    <span style="font-weight: bold; color: #bdc1c6;">–ñ–∏–≤–æ–π —á–∞—Ç</span>
                </div>
                <div class="forum-posts" id="forumPosts"></div>
                <div class="forum-input-area">
                    <input id="forumName" placeholder="–ò–º—è" maxlength="15">
                    <textarea id="forumText" placeholder="–°–æ–æ–±—â–µ–Ω–∏–µ..." maxlength="200"></textarea>
                    <button class="forum-btn" onclick="sendPost()">‚û§</button>
                </div>
            </div>

        </div>
    </div>

<script>
    // --- –ü–ï–†–ï–í–û–î–ß–ò–ö ---
    const beerMap = {'–ê': '–≤–ª–¥–∞–æ–ª–¥—Ü—Ç3894', '–ë': '78–µ–º9—Ç4325243895—Ç–º72', '–í': '–∞—Ç–¥–ª–∂–∏—ã—Ñ–≤–µ–∏0653', '–ì': '—Ç–º—â—ã—à–µ–≤–∑34', '–î': '34—Ç—Ä–∏537—É–∏–∞–¥–ª–≤—ã', '–ï': '—å02–º392–º7', '–Å': '—å02–º392–º8', '–ñ': '—Ç—Ç32–º4–æ35—Ç2', '–ó': '3–∏45—Ä—Ç647—å8', '–ò': '49–∏357—Ç7—Ç50–∏—Ü7', '–ô': '49–∏357—Ç7—Ç50–∏—Ü8', '–ö': '—Ç–π89–∏5446', '–õ': '7—å—Ç47—Ç—Ç—å75', '–ú': '7—å65–±—å47456—å7', '–ù': '8674—å5–±867–∫—É–µ–∫–≤', '–û': '—å7—Ç3567–æ5643654', '–ü': '—Ç76376534—ã–≤—Ç–Ω', '–†': '–≤—å—Ç–∞–ø–≥—å67767—å5–∫–µ', '–°': '–ø–∏–∞–≤—ã–µ54', '–¢': '—Ç65436–æ—Ç–µ–∫–Ω—Ä', '–£': '6—Ç54—É65—Ç6—Ü—É3', '–§': '74567–æ5—Ç–Ω–∏—Ç7546', '–•': '547—Ç456756—Ç85', '–¶': '7–ª—å564–ª7–æ—Ç546—Ä546', '–ß': '87645—å—Ç5–∫—É—å–ª–Ω–∞–µ–Ω–≥–µ–Ω', '–®': '–∞–µ—Ç–∫—É–Ω—É45654–Ω', '–©': '–∞–µ—Ç–∫—É–Ω—É45654–Ω1', '–™': '22987—Ç6–∏0222–ª–≤–¥–ø—Ñ—ã1', '–´': '22987—Ç6–∏0222–ª–≤–¥–ø—Ñ—ã3', '–¨': '22987—Ç6–∏0222–ª–≤–¥–ø—Ñ—ã2', '–≠': '638—å54–∏96346–∏0345', '–Æ': '–µ0—Ü4539–∏587—Ç3450879345', '–Ø': '–µ—å–µ–∫—É—Ç–Ω—Ç–µ–∫6–Ω—è', 'A': 'z99x11v', 'B': 'bb77beer00', 'C': 'c_shakal_99', 'D': 'd88_vottak_2', 'E': 'e_pivo_1', 'F': 'f_44_ff', 'G': 'g_top_g_7', 'H': 'h_hh_888', 'I': 'i_eye_111', 'J': 'j_jack_55', 'K': 'k_kick_0', 'L': 'l_lose_77', 'M': 'm_m_444555', 'N': 'n_nitro_9', 'O': 'o_zero_00', 'P': 'p_pub_4', 'Q': 'q_quest_1', 'R': 'r_root_66', 'S': 's_snk_33', 'T': 't_tank_4', 'U': 'u_unit_22', 'V': 'v_v_666', 'W': 'w_wow_7', 'X': 'x_xxx_0', 'Y': 'y_yes_9', 'Z': 'z_zzz_1'};
    const reverseCodes = Object.entries(beerMap).map(([letter, code]) => ({ letter, code })).sort((a, b) => b.code.length - a.code.length);
    let isBeerToText = false;
    function toggleMode() { isBeerToText = !isBeerToText; document.getElementById('left-label').innerText = isBeerToText ? '–ü–∏–≤–Ω–æ–π —è–∑—ã–∫' : '–¢–µ–∫—Å—Ç'; document.getElementById('right-label').innerText = isBeerToText ? '–¢–µ–∫—Å—Ç' : '–ü–∏–≤–Ω–æ–π —è–∑—ã–∫'; clearAll(); }
    function doTranslate() { 
        const input = document.getElementById('input-text').value; const output = document.getElementById('output-field'); 
        if (!input) { output.innerText = ''; return; } 
        if (!isBeerToText) { let result = ''; for (let char of input.toUpperCase()) { result += beerMap[char] || char; } output.innerText = result; } 
        else { let result = ''; let i = 0; while (i < input.length) { let found = false; for (let item of reverseCodes) { if (input.substr(i, item.code.length) === item.code) { result += item.letter; i += item.code.length; found = true; break; } } if (!found) { result += input[i]; i++; } } output.innerText = result.toLowerCase(); }
    }
    function clearAll() { document.getElementById('input-text').value = ''; document.getElementById('output-field').innerText = ''; }
    function copyResult() { const text = document.getElementById('output-field').innerText; if (!text) return; navigator.clipboard.writeText(text).then(() => { const svg = document.getElementById('copy-icon'); const old = svg.innerHTML; svg.innerHTML = '<path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"/>'; setTimeout(() => svg.innerHTML = old, 2000); }); }

    // --- GAME SYSTEM ---
    const modal = document.getElementById('gameModal'); const menu = document.getElementById('gameMenu'); let activeIntervals = [];
    function openGameModal() { modal.style.display = 'flex'; backToMenu(); }
    function closeGameModal() { modal.style.display = 'none'; stopAllGames(); }
    function backToMenu() { stopAllGames(); menu.style.display = 'grid'; if(window.innerWidth > 600) menu.style.display = 'grid'; ['snakeContainer', 'minesContainer', 'geoContainer', 'casinoContainer', 'clickerContainer', 'forumContainer'].forEach(id => { document.getElementById(id).style.display = 'none'; }); document.getElementById('gameTitle').innerText = '–ú–µ–Ω—é –ê—Ä–∫–∞–¥'; }
    function stopAllGames() { activeIntervals.forEach(i => clearInterval(i)); activeIntervals = []; if(typeof saveClicker === 'function') saveClicker(); }

    // --- CASINO ---
    let casinoBalance = 10;
    function initCasino() { menu.style.display = 'none'; document.getElementById('casinoContainer').style.display = 'flex'; document.getElementById('gameTitle').innerText = '–ö–∞–∑–∏–Ω–æ'; updateCasinoUI(); document.getElementById('casinoMsg').innerText = "–®–∞–Ω—Å 30% –≤—ã–∏–≥—Ä–∞—Ç—å 2x"; document.getElementById('casinoMsg').style.color = "#bdc1c6"; }
    function updateCasinoUI() { document.getElementById('casinoBalance').innerText = '$' + casinoBalance; }
    function playCasino() {
        const input = document.getElementById('casinoBet'); const msg = document.getElementById('casinoMsg'); let bet = Number(input.value);
        if (!Number.isInteger(bet) || bet <= 0) { msg.innerText = "–¢–æ–ª—å–∫–æ —Ü–µ–ª—ã–µ —á–∏—Å–ª–∞ > 0!"; msg.style.color = "#f44336"; return; }
        if (bet > casinoBalance) { msg.innerText = "–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Å—Ä–µ–¥—Å—Ç–≤!"; msg.style.color = "#f44336"; return; }
        const win = Math.random() < 0.3;
        if (win) { const profit = bet * 2; casinoBalance += profit; msg.innerText = `–í–´–ò–ì–†–´–®! +$${profit}`; msg.style.color = "#81c995"; } 
        else { casinoBalance -= bet; msg.innerText = `–ü–†–û–ò–ì–†–´–® -${bet}`; msg.style.color = "#e67c73"; }
        updateCasinoUI();
        if (casinoBalance <= 0) { setTimeout(() => { alert("–í—ã –ø—Ä–æ–∏–≥—Ä–∞–ª–∏ –≤—Å–µ –¥–µ–Ω—å–≥–∏!\n–í–∞—Å –≤—ã–∫–∏–¥—ã–≤–∞–µ—Ç –∏–∑ –∫–∞–∑–∏–Ω–æ."); casinoBalance = 10; input.value = ''; backToMenu(); }, 500); }
    }

    // --- CLICKER ---
    let clickerData = { cookies: 0, total: 0, buildings: [ { id: 0, name: '–ö—É—Ä—Å–æ—Ä', baseCost: 15, count: 0, cps: 0.1, icon: 'üëÜ' }, { id: 1, name: '–ë–∞–±—É—à–∫–∞', baseCost: 100, count: 0, cps: 1, icon: 'üëµ' }, { id: 2, name: '–ü–æ–ª–µ —Ö–º–µ–ª—è', baseCost: 1100, count: 0, cps: 8, icon: 'üåæ' }, { id: 3, name: '–®–∞—Ö—Ç–∞ —Å–æ–ª–æ–¥–∞', baseCost: 12000, count: 0, cps: 47, icon: '‚õèÔ∏è' }, { id: 4, name: '–ü–∏–≤–Ω–æ–π –∑–∞–≤–æ–¥', baseCost: 130000, count: 0, cps: 260, icon: 'üè≠' }, { id: 5, name: '–ë–∞–Ω–∫', baseCost: 1400000, count: 0, cps: 1400, icon: 'üè¶' }, { id: 6, name: '–•—Ä–∞–º', baseCost: 20000000, count: 0, cps: 7800, icon: 'üèõÔ∏è' }, { id: 7, name: '–ú–∞—à–∏–Ω–∞ –≤—Ä–µ–º–µ–Ω–∏', baseCost: 330000000, count: 0, cps: 44000, icon: '‚è≥' } ] };
    function initClicker() {
        menu.style.display = 'none'; document.getElementById('clickerContainer').style.display = 'flex'; document.getElementById('gameTitle').innerText = 'Beer Clicker';
        const saved = localStorage.getItem('beerClickerSave');
        if(saved) { const parsed = JSON.parse(saved); clickerData.cookies = parsed.cookies; clickerData.total = parsed.total || 0; parsed.buildings.forEach((b, i) => { if(clickerData.buildings[i]) clickerData.buildings[i].count = b.count; }); }
        renderStore(); updateClickerUI();
        const interval = setInterval(() => { const cps = getCpS(); if(cps > 0) { clickerData.cookies += cps / 10; clickerData.total += cps / 10; updateClickerUI(); } }, 100);
        activeIntervals.push(interval);
        const saveInt = setInterval(saveClicker, 5000); activeIntervals.push(saveInt);
    }
    function getCpS() { return clickerData.buildings.reduce((sum, b) => sum + (b.count * b.cps), 0); }
    function getCost(b) { return Math.floor(b.baseCost * Math.pow(1.15, b.count)); }
    function formatNum(n) { if(n >= 1000000) return (n/1000000).toFixed(2) + 'M'; if(n >= 1000) return (n/1000).toFixed(1) + 'k'; return Math.floor(n); }
    function updateClickerUI() {
        document.getElementById('beerCount').innerText = formatNum(clickerData.cookies) + ' –ü–∏–≤–∞'; document.getElementById('beerCps').innerText = '–≤ —Å–µ–∫—É–Ω–¥—É: ' + getCpS().toFixed(1);
        clickerData.buildings.forEach(b => { const el = document.getElementById('build-btn-' + b.id); const cost = getCost(b); if(el) { if(clickerData.cookies >= cost) { el.classList.remove('locked'); el.style.opacity = '1'; } else { el.classList.add('locked'); } el.querySelector('.b-cost').innerText = formatNum(cost); } });
    }
    function renderStore() {
        const list = document.getElementById('storeList'); list.innerHTML = '';
        clickerData.buildings.forEach(b => { const div = document.createElement('div'); div.className = 'building-item locked'; div.id = 'build-btn-' + b.id; div.innerHTML = `<div class="b-icon">${b.icon}</div><div class="b-info"><div class="b-name">${b.name}</div><div class="b-cost">${getCost(b)}</div></div><div class="b-count" id="count-${b.id}">${b.count}</div>`; div.onclick = () => buyBuilding(b); list.appendChild(div); });
    }
    function buyBuilding(b) { const cost = getCost(b); if(clickerData.cookies >= cost) { clickerData.cookies -= cost; b.count++; document.getElementById('count-' + b.id).innerText = b.count; updateClickerUI(); } }
    function saveClicker() { localStorage.setItem('beerClickerSave', JSON.stringify(clickerData)); }
    document.getElementById('bigCookie').addEventListener('mousedown', (e) => {
        clickerData.cookies++; clickerData.total++; updateClickerUI();
        const floatEl = document.createElement('div'); floatEl.className = 'click-text'; floatEl.innerText = '+1';
        const rect = e.target.getBoundingClientRect(); floatEl.style.left = (e.clientX - rect.left) + 'px'; floatEl.style.top = (e.clientY - rect.top) + 'px';
        e.target.parentNode.appendChild(floatEl); setTimeout(() => floatEl.remove(), 1000);
    });

    // --- OTHER GAMES (SNAKE, MINES, GEO, GRAVITY) ---
    const countries = [{name:"–ê—Ñ–≥–∞–Ω–∏—Å—Ç–∞–Ω",code:"af"},{name:"–ê–ª–±–∞–Ω–∏—è",code:"al"},{name:"–ë—Ä–∞–∑–∏–ª–∏—è",code:"br"},{name:"–ö–∞–Ω–∞–¥–∞",code:"ca"},{name:"–ö–∏—Ç–∞–π",code:"cn"},{name:"–ì–µ—Ä–º–∞–Ω–∏—è",code:"de"},{name:"–ò—Å–ø–∞–Ω–∏—è",code:"es"},{name:"–§—Ä–∞–Ω—Ü–∏—è",code:"fr"},{name:"–í–µ–ª–∏–∫–æ–±—Ä–∏—Ç–∞–Ω–∏—è",code:"gb"},{name:"–Ø–ø–æ–Ω–∏—è",code:"jp"},{name:"–°–®–ê",code:"us"},{name:"–†–æ—Å—Å–∏—è",code:"ru"}];
    let geoScoreVal = 0;
    function initGeo() { menu.style.display = 'none'; document.getElementById('geoContainer').style.display = 'flex'; geoScoreVal = 0; nextGeo(); }
    function nextGeo() {
        document.getElementById('geoScore').innerText = "–°—á–µ—Ç: " + geoScoreVal; const correct = countries[Math.floor(Math.random() * countries.length)]; const flagBox = document.getElementById('geoFlag'); flagBox.innerHTML = `<div style="color:#5f6368">–ó–∞–≥—Ä—É–∑–∫–∞...</div>`;
        const img = new Image(); img.src = `https://flagcdn.com/w320/${correct.code}.png`; img.className = "geo-flag-img"; img.onload = () => { flagBox.innerHTML = ''; flagBox.appendChild(img); };
        let opts = [correct]; while(opts.length < 4) { let r = countries[Math.floor(Math.random()*countries.length)]; if(!opts.includes(r)) opts.push(r); } opts.sort(() => Math.random() - 0.5);
        const optBox = document.getElementById('geoOptions'); optBox.innerHTML = '';
        opts.forEach(o => { const b = document.createElement('button'); b.className = 'game-btn'; b.innerText = o.name; b.onclick = () => { if(o === correct) { geoScoreVal++; b.style.background = '#81c995'; setTimeout(nextGeo, 200); } else { b.style.background = '#f44336'; setTimeout(() => { alert("–ò–≥—Ä–∞ –æ–∫–æ–Ω—á–µ–Ω–∞. –≠—Ç–æ: " + correct.name); backToMenu(); }, 100); } }; optBox.appendChild(b); });
    }
    
    function initSnake() {
        menu.style.display = 'none'; document.getElementById('snakeContainer').style.display = 'flex'; const canvas = document.getElementById('snake-canvas'); const ctx = canvas.getContext('2d');
        let s = [{x:200, y:150}], f = {x:100, y:100}, d = 'R', sc = 0;
        document.onkeydown = e => { if(e.key==='ArrowUp' && d!=='D') d='U'; if(e.key==='ArrowDown' && d!=='U') d='D'; if(e.key==='ArrowLeft' && d!=='R') d='L'; if(e.key==='ArrowRight' && d!=='L') d='R'; };
        let tX, tY; canvas.ontouchstart = e => { tX = e.touches[0].clientX; tY = e.touches[0].clientY; };
        canvas.ontouchmove = e => { if(!tX || !tY) return; let dX = e.touches[0].clientX - tX; let dY = e.touches[0].clientY - tY; if(Math.abs(dX) > Math.abs(dY)) { if(dX > 0 && d!=='L') d='R'; else if(dX < 0 && d!=='R') d='L'; } else { if(dY > 0 && d!=='U') d='D'; else if(dY < 0 && d!=='D') d='U'; } tX = null; tY = null; e.preventDefault(); };
        const int = setInterval(() => { let h = {...s[0]}; if(d==='U') h.y-=10; if(d==='D') h.y+=10; if(d==='L') h.x-=10; if(d==='R') h.x+=10; if(h.x<0||h.x>=400||h.y<0||h.y>=300||s.some(p=>p.x===h.x&&p.y===h.y)) { clearInterval(int); alert("–û—á–∫–∏: " + sc); backToMenu(); } s.unshift(h); if(h.x===f.x && h.y===f.y) { sc++; f={x:Math.floor(Math.random()*39)*10, y:Math.floor(Math.random()*29)*10}; } else s.pop(); ctx.fillStyle = '#000'; ctx.fillRect(0,0,400,300); ctx.fillStyle = '#f00'; ctx.fillRect(f.x,f.y,9,9); ctx.fillStyle = '#8ab4f8'; s.forEach(p=>ctx.fillRect(p.x,p.y,9,9)); }, 100); activeIntervals.push(int);
    }

    let minesState = []; const MS_COLS = 10; const MS_ROWS = 10;
    function initMinesweeper() {
        menu.style.display = 'none'; document.getElementById('minesContainer').style.display = 'flex'; const grid = document.getElementById('minesGrid'); grid.style.gridTemplateColumns = `repeat(${MS_COLS}, 30px)`; grid.innerHTML = '';
        minesState = Array(MS_COLS * MS_ROWS).fill(0).map((_,i) => ({ i, mine: Math.random() < 0.15, rev: false, flag: false, el: null }));
        minesState.forEach(c => { const d = document.createElement('div'); d.className = 'mine-cell'; c.el = d; let pressTimer, isLongPress = false; d.addEventListener('touchstart', () => { isLongPress = false; pressTimer = setTimeout(() => { isLongPress = true; toggleFlag(c); if(navigator.vibrate) navigator.vibrate(50); }, 500); }, {passive: false}); d.addEventListener('touchend', (e) => { clearTimeout(pressTimer); if (isLongPress) e.preventDefault(); }); d.addEventListener('touchmove', () => clearTimeout(pressTimer)); d.onclick = () => { if (!isLongPress && !c.flag && !c.rev) openCell(c); }; d.oncontextmenu = (e) => { e.preventDefault(); toggleFlag(c); return false; }; grid.appendChild(d); });
    }
    function toggleFlag(c) { if (c.rev) return; c.flag = !c.flag; c.el.innerText = c.flag ? 'üö©' : ''; c.el.classList.toggle('flagged', c.flag); }
    function openCell(c) { if (c.rev || c.flag) return; c.rev = true; c.el.classList.add('revealed'); if(c.mine) { c.el.classList.add('boom'); c.el.innerText = 'üí£'; setTimeout(() => { alert("–ë–∞–±–∞—Ö!"); backToMenu(); }, 100); return; } let near = 0; getNeighbors(c.i).forEach(n => { if (minesState[n].mine) near++; }); if (near > 0) { c.el.innerText = near; c.el.style.color = ['#8ab4f8', '#81c995', '#fdd663', '#f28b82'][near-1] || '#e67c73'; } else { getNeighbors(c.i).forEach(n => openCell(minesState[n])); } }
    function getNeighbors(idx) { const row = Math.floor(idx / MS_COLS), col = idx % MS_COLS, res = []; for (let x = -1; x <= 1; x++) for (let y = -1; y <= 1; y++) { if (x === 0 && y === 0) continue; const nRow = row + y, nCol = col + x; if (nRow >= 0 && nRow < MS_ROWS && nCol >= 0 && nCol < MS_COLS) res.push(nRow * MS_COLS + nCol); } return res; }

    let gravityActive = false; let physicsObjects = []; let mouse = { x: 0, y: 0, down: false, draggedObj: null, lastX: 0, lastY: 0 };
    function startGravity() { if (gravityActive) return; gravityActive = true; [document.querySelector('.title-container'), document.querySelector('.translator-container')].forEach(el => { if(!el) return; const r = el.getBoundingClientRect(); const obj = { el, x: r.left, y: r.top, w: r.width, h: r.height, vx: (Math.random()-0.5)*10, vy: 0, rot: 0, rotSpeed: (Math.random()-0.5)*2 }; physicsObjects.push(obj); el.style.position = 'fixed'; el.style.width = r.width+'px'; el.style.margin = '0'; el.style.zIndex = '9999'; el.style.top = '0'; el.style.left = '0'; el.style.transform = `translate(${r.left}px, ${r.top}px)`; el.onmousedown = (e) => startDrag(e, obj, e.clientX, e.clientY); el.ontouchstart = (e) => { e.preventDefault(); startDrag(e, obj, e.touches[0].clientX, e.touches[0].clientY); }; }); window.addEventListener('mousemove', (e) => moveDrag(e.clientX, e.clientY)); window.addEventListener('touchmove', (e) => moveDrag(e.touches[0].clientX, e.touches[0].clientY)); window.addEventListener('mouseup', endDrag); window.addEventListener('touchend', endDrag); requestAnimationFrame(updatePhys); }
    function startDrag(e, o, x, y) { mouse.down = true; mouse.draggedObj = o; mouse.offsetX = x - o.x; mouse.offsetY = y - o.y; o.vx = 0; o.vy = 0; mouse.lastX = x; mouse.lastY = y; }
    function moveDrag(x, y) { if (!mouse.down || !mouse.draggedObj) return; const o = mouse.draggedObj; o.x = x - mouse.offsetX; o.y = y - mouse.offsetY; o.vx = x - mouse.lastX; o.vy = y - mouse.lastY; mouse.lastX = x; mouse.lastY = y; }
    function endDrag() { mouse.down = false; mouse.draggedObj = null; }
    function updatePhys() { if (!gravityActive) return; physicsObjects.forEach(o => { if (!mouse.down || mouse.draggedObj !== o) { o.vy += 0.5; o.x += o.vx; o.y += o.vy; o.rot += o.rotSpeed; if (o.y + o.h > window.innerHeight) { o.y = window.innerHeight - o.h; o.vy *= -0.6; o.vx *= 0.95; } if (o.x < 0) { o.x = 0; o.vx *= -0.6; } if (o.x + o.w > window.innerWidth) { o.x = window.innerWidth - o.w; o.vx *= -0.6; } } o.el.style.transform = `translate(${o.x}px, ${o.y}px) rotate(${o.rot}deg)`; }); requestAnimationFrame(updatePhys); }
    function initForum() { menu.style.display = 'none'; document.getElementById('forumContainer').style.display = 'flex'; document.getElementById('gameTitle').innerText = '–§–æ—Ä—É–º'; }
</script>

<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>

<script>
    /* ================================================================= */
    /* –¢–í–û–ô –ö–û–ù–§–ò–ì FIREBASE (–í—Å—Ç–∞–≤–ª–µ–Ω –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏–∑ —Å–∫—Ä–∏–Ω—à–æ—Ç–∞) */
    /* ================================================================= */
   const firebaseConfig = {
  apiKey: "AIzaSyCesMs7AFeefzwVLhJfKyA3_QROoRnnONo",
  authDomain: "beerlanguage-1337.firebaseapp.com",
  databaseURL: "https://beerlanguage-1337-default-rtdb.europe-west1.firebasedatabase.app",
  projectId: "beerlanguage-1337",
  storageBucket: "beerlanguage-1337.firebasestorage.app",
  messagingSenderId: "18636363390",
  appId: "1:18636363390:web:aa02dfd1ce7e53f6d0aa2f",
  measurementId: "G-FWDWXXMHY8"
    };

    firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();
    const banned = ["http", "https", ".com", ".ru", "xxx", "porn", "casino", "viagra"];

    async function sendPost() {
        const nameIn = document.getElementById('forumName');
        const textIn = document.getElementById('forumText');
        const name = nameIn.value.trim().slice(0, 15);
        const text = textIn.value.trim().slice(0, 200);

        if (!name || !text) return;
        
        // –§–∏–ª—å—Ç—Ä —Å–ª–æ–≤
        const lower = text.toLowerCase();
        if (banned.some(w => lower.includes(w))) return alert("–°–æ–æ–±—â–µ–Ω–∏–µ —Å–æ–¥–µ—Ä–∂–∏—Ç –∑–∞–ø—Ä–µ—â–µ–Ω–Ω—ã–µ —Å–ª–æ–≤–∞.");

        try {
            await db.collection("posts").add({
                name: name,
                text: text,
                timestamp: firebase.firestore.FieldValue.serverTimestamp()
            });
            textIn.value = ""; // –û—á–∏—Å—Ç–∫–∞
        } catch(error) {
            console.error("–û—à–∏–±–∫–∞:", error);
            alert("–ù–µ —É–¥–∞–ª–æ—Å—å –æ—Ç–ø—Ä–∞–≤–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ. –ü—Ä–æ–≤–µ—Ä—å –∫–æ–Ω—Å–æ–ª—å (F12).");
        }
    }

    // –°–ª—É—à–∞—Ç–µ–ª—å —á–∞—Ç–∞
    db.collection("posts")
      .orderBy("timestamp", "asc")
      .limit(50)
      .onSnapshot((snapshot) => {
        const cont = document.getElementById('forumPosts');
        cont.innerHTML = "";
        
        if(snapshot.empty) {
            cont.innerHTML = '<div style="text-align:center; color:#5f6368; padding:20px;">–ü–æ–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏–π –Ω–µ—Ç...</div>';
            return;
        }

        snapshot.forEach((doc) => {
          const p = doc.data();
          if(!p.text) return;
          
          const card = document.createElement("div");
          card.className = "post-card";
          
          let timeStr = "--:--";
          if (p.timestamp) {
              const date = p.timestamp.toDate();
              const h = date.getHours().toString().padStart(2,'0');
              const m = date.getMinutes().toString().padStart(2,'0');
              timeStr = `${h}:${m}`;
          }

          card.innerHTML = `
            <div class="post-author">${escapeHtml(p.name || '–ê–Ω–æ–Ω–∏–º')} <span>${timeStr}</span></div>
            <div class="post-text">${escapeHtml(p.text)}</div>
          `;
          cont.appendChild(card);
        });
        cont.scrollTop = cont.scrollHeight; // –ê–≤—Ç–æ–ø—Ä–æ–∫—Ä—É—Ç–∫–∞ –≤–Ω–∏–∑
      }, (error) => {
          console.log(error);
          document.getElementById('forumPosts').innerHTML = `<div style="color:#f44336;text-align:center">–û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö.<br>–ü—Ä–æ–≤–µ—Ä—å –ø—Ä–∞–≤–∏–ª–∞ –¥–æ—Å—Ç—É–ø–∞ –≤ Firebase Console.</div>`;
      });

    function escapeHtml(text) {
      if (!text) return text;
      return text
        .replace(/&/g, "&amp;")
        .replace(/</g, "&lt;")
        .replace(/>/g, "&gt;")
        .replace(/"/g, "&quot;")
        .replace(/'/g, "&#039;");
    }
</script>

</body>
</html>
