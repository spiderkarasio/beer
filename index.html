<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Beer Translate & Games Ultimate</title>
    <script type="text/javascript">
        var isMobile = /iPhone|iPad|iPod|Android|BlackBerry|Opera Mini|IEMobile/i.test(navigator.userAgent);
    </script>
    <style>
        /* --- –û–°–ù–û–í–ù–´–ï –°–¢–ò–õ–ò (–¢–í–û–ò –û–†–ò–ì–ò–ù–ê–õ–¨–ù–´–ï) --- */
        body { background-color: #121316; color: #e8eaed; font-family: 'Segoe UI', sans-serif; display: flex; flex-direction: column; align-items: center; justify-content: center; min-height: 100vh; margin: 0; overflow: hidden; user-select: none; -webkit-user-select: none; touch-action: none; }
        .title-container { margin-bottom: 20px; display: flex; align-items: baseline; gap: 10px; cursor: grab; z-index: 20; }
        h1 { font-weight: 400; font-size: 32px; color: #bdc1c6; margin: 0; pointer-events: none; }
        .secret-link { color: inherit; text-decoration: none; cursor: pointer; pointer-events: auto; transition: color 0.2s; }
        .secret-link:hover { color: #8ab4f8; }
        .author-tag { font-size: 14px; color: #5f6368; font-weight: 500; opacity: 0.7; pointer-events: none; }

        .translator-container { background-color: #1e1f21; border: 1px solid #3c4043; border-radius: 12px; width: 95%; max-width: 1100px; display: flex; flex-direction: column; box-shadow: 0 10px 30px rgba(0,0,0,0.5); position: relative; z-index: 10; transition: transform 0.1s ease-out; }
        .header-tabs { display: flex; align-items: center; padding: 0 15px; border-bottom: 1px solid #3c4043; height: 55px; flex-shrink: 0; }
        .tab { color: #8ab4f8; font-size: 14px; font-weight: 500; border-bottom: 2px solid #8ab4f8; height: 100%; display: flex; align-items: center; padding: 0 10px; cursor: pointer; }
        .tab.inactive { border-bottom: 2px solid transparent; color: #9aa0a6; }
        .swap-icon { margin: 0 15px; color: #9aa0a6; cursor: pointer; font-size: 24px; }
        .right-tabs { margin-left: auto; display: flex; gap: 5px; }
        .action-tab { color: #9aa0a6; font-size: 13px; text-transform: uppercase; font-weight: bold; cursor: pointer; padding: 8px 10px; border-radius: 4px; }
        .action-tab:hover { color: #fff; background: rgba(255,255,255,0.05); }

        .main-panels { display: flex; flex-wrap: wrap; height: 100%; }
        .panel { flex: 1; min-width: 300px; min-height: 250px; padding: 20px; position: relative; display: flex; flex-direction: column; background: #1e1f21; box-sizing: border-box; }
        .input-panel { border-right: 1px solid #3c4043; }
        textarea { width: 100%; height: 100%; background: transparent; border: none; color: #fff; font-size: 20px; resize: none; outline: none; font-family: inherit; }
        #output-field { font-size: 20px; color: #bdc1c6; word-break: break-all; white-space: pre-wrap; flex-grow: 1; overflow-y: auto; }
        .clear-btn { position: absolute; top: 15px; right: 15px; color: #9aa0a6; cursor: pointer; font-size: 22px; z-index: 5; visibility: hidden; }
        .panel:hover .clear-btn { visibility: visible; }
        .copy-btn { background: transparent; border: none; color: #9aa0a6; cursor: pointer; padding: 8px; border-radius: 4px; transition: all 0.2s; display: flex; align-items: center; gap: 5px; font-size: 12px; text-transform: uppercase; font-weight: bold; }
        .copy-btn:hover { color: #fff; background: rgba(255,255,255,0.1); }

        /* --- –ò–ì–†–û–í–û–ï –û–ö–ù–û (–¢–í–û–Å) --- */
        .modal-overlay { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.85); z-index: 5000; justify-content: center; align-items: center; backdrop-filter: blur(5px); }
        .game-window { background: #1e1f21; border: 1px solid #3c4043; border-radius: 12px; width: 800px; max-width: 95%; height: 600px; max-height: 90vh; overflow: hidden; display: flex; flex-direction: column; box-shadow: 0 20px 50px rgba(0,0,0,0.7); position: relative; }
        .game-header { padding: 15px 20px; border-bottom: 1px solid #3c4043; display: flex; justify-content: space-between; align-items: center; background: #202124; }
        .game-header h2 { margin: 0; font-size: 18px; color: #bdc1c6; font-weight: 500; }
        .close-game { color: #9aa0a6; cursor: pointer; font-size: 24px; transition: color 0.2s; }
        .close-game:hover { color: #fff; }

        .game-menu { display: grid; grid-template-columns: repeat(auto-fill, minmax(180px, 1fr)); gap: 15px; padding: 25px; overflow-y: auto; }
        .game-card { background: #303134; border: 1px solid #3c4043; border-radius: 10px; padding: 20px; text-align: center; cursor: pointer; transition: all 0.2s; display: flex; flex-direction: column; align-items: center; gap: 10px; }
        .game-card:hover { background: #3c4043; transform: translateY(-5px); border-color: #8ab4f8; }
        .game-card .icon { font-size: 40px; }
        .game-card .name { font-weight: bold; color: #e8eaed; }
        .game-card .desc { font-size: 12px; color: #9aa0a6; }

        .game-content { display: none; flex-direction: column; height: 100%; position: relative; overflow: hidden; }
        .back-to-menu { position: absolute; top: 15px; left: 20px; color: #8ab4f8; cursor: pointer; z-index: 100; font-weight: 500; display: flex; align-items: center; gap: 5px; }

        /* --- –ß–ê–¢ (–ò–°–ü–†–ê–í–õ–ï–ù–ù–´–ô: GIF + ENTER) --- */
        #forumContainer { padding: 0; }
        .forum-posts { flex: 1; overflow-y: auto; padding: 20px; display: flex; flex-direction: column; gap: 15px; background: #121316; }
        .post-card { background: #1e1f21; border: 1px solid #3c4043; padding: 12px 16px; border-radius: 12px; max-width: 85%; align-self: flex-start; }
        .post-author { font-weight: bold; color: #8ab4f8; font-size: 13px; margin-bottom: 4px; display: flex; justify-content: space-between; align-items: center; gap: 15px; }
        .post-author span { color: #5f6368; font-weight: normal; font-size: 11px; }
        .post-text { font-size: 14px; line-height: 1.5; color: #e8eaed; word-break: break-word; white-space: pre-wrap; }
        .post-img { max-width: 100%; border-radius: 8px; margin-top: 10px; display: block; max-height: 300px; object-fit: contain; border: 1px solid #3c4043; }
        
        .forum-input-area { padding: 15px 20px; background: #202124; border-top: 1px solid #3c4043; display: flex; gap: 12px; align-items: flex-end; }
        .forum-inputs-left { display: flex; flex-direction: column; gap: 8px; flex: 1; }
        #forumName { background: #303134; border: 1px solid #3c4043; border-radius: 6px; color: #fff; padding: 8px 12px; font-size: 13px; width: 150px; outline: none; }
        #forumText { background: #303134; border: 1px solid #3c4043; border-radius: 6px; color: #fff; padding: 10px 12px; font-size: 14px; resize: none; outline: none; min-height: 40px; max-height: 120px; font-family: inherit; }
        .send-btn { background: #8ab4f8; color: #1e1f21; border: none; border-radius: 6px; width: 42px; height: 42px; cursor: pointer; display: flex; align-items: center; justify-content: center; transition: all 0.2s; flex-shrink: 0; }
        .send-btn:hover { background: #aecbfa; transform: scale(1.05); }

        /* --- –ö–õ–ò–ö–ï–† (–¢–í–û–ô –ü–û–õ–ù–´–ô) --- */
        .clicker-layout { display: flex; height: 100%; }
        .clicker-main { flex: 1; display: flex; flex-direction: column; align-items: center; justify-content: center; background: radial-gradient(circle at center, #2c2d30 0%, #121316 100%); position: relative; padding: 20px; }
        .clicker-stats { position: absolute; top: 60px; text-align: center; pointer-events: none; }
        #beerCount { font-size: 42px; font-weight: bold; color: #fff; text-shadow: 0 4px 10px rgba(0,0,0,0.5); }
        #beerCps { color: #9aa0a6; font-size: 16px; margin-top: 5px; }
        .big-cookie-container { position: relative; width: 250px; height: 250px; display: flex; align-items: center; justify-content: center; margin-top: 40px; }
        .big-cookie { width: 100%; height: 100%; background: url('https://img.icons8.com/color/480/beer-glass.png') no-repeat center/contain; cursor: pointer; transition: transform 0.05s; z-index: 2; filter: drop-shadow(0 10px 20px rgba(0,0,0,0.4)); }
        .big-cookie:active { transform: scale(0.92); }
        .clicker-shop { width: 300px; background: #202124; border-left: 1px solid #3c4043; display: flex; flex-direction: column; }
        .shop-header { padding: 15px; background: #303134; font-weight: bold; text-align: center; border-bottom: 1px solid #3c4043; }
        #storeList { flex: 1; overflow-y: auto; }
        .building-item { display: flex; align-items: center; padding: 12px 15px; border-bottom: 1px solid #3c4043; cursor: pointer; transition: background 0.2s; position: relative; }
        .building-item:hover { background: #2c2d30; }
        .building-item.locked { opacity: 0.5; filter: grayscale(1); cursor: not-allowed; }
        .b-icon { font-size: 30px; width: 45px; height: 45px; display: flex; align-items: center; justify-content: center; background: #303134; border-radius: 8px; margin-right: 12px; }
        .b-info { flex: 1; }
        .b-name { font-weight: bold; font-size: 14px; margin-bottom: 2px; }
        .b-cost { font-size: 12px; color: #81c995; font-weight: bold; }
        .b-count { font-size: 24px; color: #3c4043; font-weight: bold; margin-left: 10px; }
        .building-item:not(.locked) .b-count { color: #5f6368; }

        /* –°–ê–ü–ï–† */
        .mines-container { display: flex; flex-direction: column; align-items: center; justify-content: center; height: 100%; gap: 20px; }
        .mines-grid { display: grid; grid-template-columns: repeat(10, 32px); grid-template-rows: repeat(10, 32px); gap: 2px; background: #3c4043; border: 3px solid #3c4043; border-radius: 4px; }
        .mine-cell { width: 32px; height: 32px; background: #bdc1c6; border: 2px solid; border-color: #eee #888 #888 #eee; display: flex; align-items: center; justify-content: center; font-weight: bold; cursor: pointer; font-size: 18px; }
        .mine-cell.revealed { background: #d1d1d1; border: 1px solid #999; }
        .mine-cell.mine { background: #ea4335; }

        /* –ó–ú–ï–ô–ö–ê */
        .snake-container { display: flex; flex-direction: column; align-items: center; justify-content: center; height: 100%; gap: 15px; }
        #snake-canvas { background: #000; border: 4px solid #303134; border-radius: 8px; box-shadow: 0 0 20px rgba(0,0,0,0.5); }

        /* –§–õ–ê–ì–ò */
        .geo-container { display: flex; flex-direction: column; align-items: center; justify-content: center; height: 100%; padding: 40px; text-align: center; }
        #geoFlag { font-size: 120px; margin: 20px 0; filter: drop-shadow(0 5px 15px rgba(0,0,0,0.3)); }
        #geoOptions { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; width: 100%; max-width: 500px; }
        .geo-btn { background: #303134; border: 1px solid #3c4043; color: #fff; padding: 15px; border-radius: 10px; cursor: pointer; font-size: 16px; transition: all 0.2s; }
        .geo-btn:hover { background: #3c4043; border-color: #8ab4f8; }

        /* –ö–ê–ó–ò–ù–û */
        .casino-container { display: flex; flex-direction: column; align-items: center; justify-content: center; height: 100%; gap: 25px; }
        .casino-card { background: #202124; border: 1px solid #3c4043; border-radius: 20px; padding: 40px; width: 350px; text-align: center; box-shadow: 0 10px 30px rgba(0,0,0,0.5); }
        .balance-label { font-size: 14px; color: #9aa0a6; text-transform: uppercase; letter-spacing: 1px; }
        #casinoBalance { font-size: 48px; font-weight: bold; color: #81c995; margin: 10px 0 30px 0; }
        .bet-input-wrap { display: flex; flex-direction: column; gap: 10px; margin-bottom: 25px; }
        #casinoBet { background: #303134; border: 1px solid #3c4043; border-radius: 10px; color: #fff; padding: 15px; font-size: 20px; text-align: center; outline: none; }
        .bet-btns { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; }
        .bet-action { background: #f29900; color: #1e1f21; border: none; padding: 15px; border-radius: 10px; font-weight: bold; font-size: 18px; cursor: pointer; transition: all 0.2s; }
        .bet-action:hover { background: #ffad1f; transform: translateY(-2px); }
        #casinoMsg { height: 20px; font-size: 14px; margin-top: 15px; font-weight: 500; }
    </style>
</head>
<body>

    <div class="title-container" id="title-drag">
        <h1>
            <a href="https://www.roblox.com/games/111530421351096/You-VS-Homer#!/game-instances" class="secret-link">B</a>ee<a href="https://beerlanguage.ru/rat" class="secret-link">r</a> 
            Tran<a href="https://beerlanguage.ru/Caesar" class="secret-link">s</a>late & Games
        </h1>
        <span class="author-tag">Ultimate Edition</span>
    </div>

    <div class="translator-container" id="main-block">
        <div class="header-tabs">
            <div class="tab" id="left-label">–¢–µ–∫—Å—Ç</div>
            <div class="swap-icon" onclick="toggleMode()">‚áÑ</div>
            <div class="tab inactive" id="right-label">–ü–∏–≤–Ω–æ–π —è–∑—ã–∫</div>
            <div class="right-tabs">
                <div class="action-tab" onclick="openGameModal()">–ú–µ–Ω—é / –ò–≥—Ä—ã</div>
                <div class="action-tab" onclick="startGravity()">–ì—Ä–∞–≤–∏—Ç–∞—Ü–∏—è</div>
            </div>
        </div>
        <div class="main-panels">
            <div class="panel input-panel">
                <div class="clear-btn" onclick="clearInput()">‚úï</div>
                <textarea id="input-text" placeholder="–í–≤–µ–¥–∏—Ç–µ —Ç–µ–∫—Å—Ç..." oninput="doTranslate()"></textarea>
            </div>
            <div class="panel">
                <div id="output-field"></div>
                <div style="position: absolute; bottom: 12px; right: 12px;">
                    <button class="copy-btn" onclick="copyToClipboard()">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                        –ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å
                    </button>
                </div>
            </div>
        </div>
    </div>

    <div class="modal-overlay" id="gameModal">
        <div class="game-window">
            <div class="game-header">
                <h2 id="gameTitle">–ò–≥—Ä–æ–≤–æ–µ –ú–µ–Ω—é</h2>
                <div class="close-game" onclick="closeGameModal()">‚úï</div>
            </div>
            
            <div class="game-menu" id="gameMenu">
                <div class="game-card" onclick="openForum()">
                    <div class="icon">üí¨</div>
                    <div class="name">–ñ–ò–í–û–ô –ß–ê–¢</div>
                    <div class="desc">–û–±—â–µ–Ω–∏–µ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏</div>
                </div>
                <div class="game-card" onclick="openClicker()">
                    <div class="icon">üç∫</div>
                    <div class="name">Beer Clicker</div>
                    <div class="desc">–°—Ç–∞–Ω—å –ø–∏–≤–Ω—ã–º –º–∞–≥–Ω–∞—Ç–æ–º</div>
                </div>
                <div class="game-card" onclick="openMines()">
                    <div class="icon">üí£</div>
                    <div class="name">–°–∞–ø–µ—Ä</div>
                    <div class="desc">–ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∞—è –≥–æ–ª–æ–≤–æ–ª–æ–º–∫–∞</div>
                </div>
                <div class="game-card" onclick="openSnake()">
                    <div class="icon">üêç</div>
                    <div class="name">–ó–º–µ–π–∫–∞</div>
                    <div class="desc">–°—Ç–∞—Ä–æ–µ –¥–æ–±—Ä–æ–µ —Ä–µ—Ç—Ä–æ</div>
                </div>
                <div class="game-card" onclick="openGeo()">
                    <div class="icon">üåç</div>
                    <div class="name">–£–≥–∞–¥–∞–π –§–ª–∞–≥</div>
                    <div class="desc">–ü—Ä–æ–≤–µ—Ä—å —Å–≤–æ–∏ –∑–Ω–∞–Ω–∏—è –≥–µ–æ–≥—Ä–∞—Ñ–∏–∏</div>
                </div>
                <div class="game-card" onclick="openCasino()">
                    <div class="icon">üé≤</div>
                    <div class="name">–ü–∏–≤–Ω–æ–µ –ö–∞–∑–∏–Ω–æ</div>
                    <div class="desc">–†–∏—Å–∫–Ω–∏ –≤—Å–µ–º —Ä–∞–¥–∏ –ø–æ–±–µ–¥—ã</div>
                </div>
            </div>

            <div id="forumContainer" class="game-content">
                <div class="back-to-menu" onclick="backToMenu()">‚Üê –ù–∞–∑–∞–¥ –∫ –º–µ–Ω—é</div>
                <div class="forum-posts" id="forumPosts"></div>
                <div class="forum-input-area">
                    <div class="forum-inputs-left">
                        <input type="text" id="forumName" placeholder="–í–∞—à–µ –∏–º—è" maxlength="15">
                        <textarea id="forumText" placeholder="–°–æ–æ–±—â–µ–Ω–∏–µ... (GIF —Å—Å—ã–ª–∫–∏ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç—Å—è)" maxlength="500"></textarea>
                    </div>
                    <button class="send-btn" onclick="sendPost()">‚û§</button>
                </div>
            </div>

            <div id="clickerContainer" class="game-content">
                <div class="back-to-menu" onclick="backToMenu(); saveClicker();">‚Üê –í –º–µ–Ω—é (–°–æ—Ö—Ä–∞–Ω–∏—Ç—å)</div>
                <div class="clicker-layout">
                    <div class="clicker-main">
                        <div class="clicker-stats">
                            <div id="beerCount">0 –ü–∏–≤–∞</div>
                            <div id="beerCps">–≤ —Å–µ–∫—É–Ω–¥—É: 0</div>
                        </div>
                        <div class="big-cookie-container">
                            <div class="big-cookie" id="bigCookie"></div>
                        </div>
                    </div>
                    <div class="clicker-shop">
                        <div class="shop-header">–ú–∞–≥–∞–∑–∏–Ω —É–ª—É—á—à–µ–Ω–∏–π</div>
                        <div id="storeList"></div>
                    </div>
                </div>
            </div>

            <div id="minesContainer" class="game-content">
                <div class="back-to-menu" onclick="backToMenu()">‚Üê –ù–∞–∑–∞–¥</div>
                <div class="mines-container">
                    <div style="font-size: 20px; font-weight: bold; color: #bdc1c6;">–°–ê–ü–ï–†</div>
                    <div class="mines-grid" id="minesGrid"></div>
                    <button class="geo-btn" onclick="initMinesweeper()" style="padding: 10px 20px;">–ù–∞—á–∞—Ç—å –∑–∞–Ω–æ–≤–æ</button>
                </div>
            </div>

            <div id="snakeContainer" class="game-content">
                <div class="back-to-menu" onclick="backToMenu()">‚Üê –ù–∞–∑–∞–¥</div>
                <div class="snake-container">
                    <div id="snakeScore" style="font-size: 24px; font-weight: bold;">–°—á–µ—Ç: 0</div>
                    <canvas id="snake-canvas" width="400" height="400"></canvas>
                    <div style="color: #5f6368; font-size: 12px;">–ò—Å–ø–æ–ª—å–∑—É–π —Å—Ç—Ä–µ–ª–æ—á–∫–∏ –Ω–∞ –∫–ª–∞–≤–∏–∞—Ç—É—Ä–µ</div>
                </div>
            </div>

            <div id="geoContainer" class="game-content">
                <div class="back-to-menu" onclick="backToMenu()">‚Üê –ù–∞–∑–∞–¥</div>
                <div class="geo-container">
                    <div id="geoScoreDisplay" style="font-size: 24px; font-weight: bold; color: #8ab4f8;">–°—á–µ—Ç: 0</div>
                    <div id="geoFlag"></div>
                    <div id="geoOptions"></div>
                </div>
            </div>

            <div id="casinoContainer" class="game-content">
                <div class="back-to-menu" onclick="backToMenu()">‚Üê –ù–∞–∑–∞–¥</div>
                <div class="casino-container">
                    <div class="casino-card">
                        <div class="balance-label">–í–∞—à –ë–∞–ª–∞–Ω—Å</div>
                        <div id="casinoBalance">$10</div>
                        <div class="bet-input-wrap">
                            <input type="number" id="casinoBet" value="10" min="1">
                            <div class="bet-btns">
                                <button class="geo-btn" style="padding: 8px;" onclick="adjustBet(0.5)">x0.5</button>
                                <button class="geo-btn" style="padding: 8px;" onclick="adjustBet(2)">x2</button>
                            </div>
                        </div>
                        <button class="bet-action" onclick="playCasino()">–ü–û–°–¢–ê–í–ò–¢–¨</button>
                        <div id="casinoMsg"></div>
                    </div>
                </div>
            </div>

        </div>
    </div>

<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>

<script>
    // --- –î–ê–ù–ù–´–ï –ò –ü–ï–†–ï–í–û–î (–¢–í–û–ò –†–û–î–ù–´–ï) ---
    const beerMap = {'–ê': '–≤–ª–¥–∞–æ–ª–¥—Ü—Ç3894', '–ë': '78–µ–º9—Ç4325243895—Ç–º72', '–í': '–∞—Ç–¥–ª–∂–∏—ã—Ñ–≤–µ–∏0653', '–ì': '—Ç–º—â—ã—à–µ–≤–∑34', '–î': '34—Ç—Ä–∏537—É–∏–∞–¥–ª–≤—ã', '–ï': '—å02–º392–º7', '–Å': '—å02–º392–º8', '–ñ': '—Ç—Ç32–º4–æ35—Ç2', '–ó': '3–∏45—Ä—Ç647—å8', '–ò': '49–∏357—Ç7—Ç50–∏—Ü7', '–ô': '49–∏357—Ç7—Ç50–∏—Ü8', '–ö': '—Ç–π89–∏5446', '–õ': '7—å—Ç47—Ç—Ç—å75', '–ú': '7—å65–±—å47456—å7', '–ù': '8674—å5–±867–∫—É–µ–∫–≤', '–û': '—å7—Ç3567–æ5643654', '–ü': '—Ç76376534—ã–≤—Ç–Ω', '–†': '–≤—å—Ç–∞–ø–≥—å67767—å5–∫–µ', '–°': '–ø–∏–∞–≤—ã–µ54', '–¢': '—Ç65436–æ—Ç–µ–∫–Ω—Ä', '–£': '6—Ç54—É65—Ç6—Ü—É3', '–§': '74567–æ5—Ç–Ω–∏—Ç7546', '–•': '547—Ç456756—Ç85', '–¶': '7–ª—å564–ª7–æ—Ç546—Ä546', '–ß': '87645—å—Ç5–∫—É—å–ª–Ω–∞–µ–Ω–≥–µ–Ω', '–®': '–∞–µ—Ç–∫—É–Ω—É45654–Ω', '–©': '–∞–µ—Ç–∫—É–Ω—É45654–Ω1', '–™': '22987—Ç6–∏0222–ª–≤–¥–ø—Ñ—ã1', '–´': '22987—Ç6–∏0222–ª–≤–¥–ø—Ñ—ã3', '–¨': '22987—Ç6–∏0222–ª–≤–¥–ø—Ñ—ã2', '–≠': '638—å54–∏96346–∏0345', '–Æ': '–µ0—Ü4539–∏587—Ç3450879345', '–Ø': '–µ—å–µ–∫—É—Ç–Ω—Ç–µ–∫6–Ω—è', 'A': 'z99x11v', 'B': 'bb77beer00', 'C': 'c_shakal_99', 'D': 'd88_vottak_2', 'E': 'e_pivo_1', 'F': 'f_44_ff', 'G': 'g_top_g_7', 'H': 'h_hh_888', 'I': 'i_eye_111', 'J': 'j_jack_55', 'K': 'k_kick_0', 'L': 'l_lose_77', 'M': 'm_m_444555', 'N': 'n_nitro_9', 'O': 'o_zero_00', 'P': 'p_pub_4', 'Q': 'q_quest_1', 'R': 'r_root_66', 'S': 's_snk_33', 'T': 't_tank_4', 'U': 'u_unit_22', 'V': 'v_v_666', 'W': 'w_wow_7', 'X': 'x_xxx_0', 'Y': 'y_yes_9', 'Z': 'z_zzz_1'};
    const reverseCodes = Object.entries(beerMap).map(([letter, code]) => ({ letter, code })).sort((a, b) => b.code.length - a.code.length);
    let isBeerToText = false;

    function toggleMode() {
        isBeerToText = !isBeerToText;
        document.getElementById('left-label').classList.toggle('inactive');
        document.getElementById('right-label').classList.toggle('inactive');
        document.getElementById('input-text').value = '';
        document.getElementById('output-field').innerText = '';
    }

    function doTranslate() {
        const input = document.getElementById('input-text').value;
        const output = document.getElementById('output-field');
        if (!input) { output.innerText = ''; return; }
        if (!isBeerToText) {
            let res = '';
            for (let char of input.toUpperCase()) { res += beerMap[char] || char; }
            output.innerText = res;
        } else {
            let res = ''; let i = 0;
            while (i < input.length) {
                let found = false;
                for (let item of reverseCodes) {
                    if (input.substr(i, item.code.length) === item.code) { res += item.letter; i += item.code.length; found = true; break; }
                }
                if (!found) { res += input[i]; i++; }
            }
            output.innerText = res.toLowerCase();
        }
    }

    function clearInput() { document.getElementById('input-text').value = ''; doTranslate(); }
    function copyToClipboard() { const text = document.getElementById('output-field').innerText; if(text) navigator.clipboard.writeText(text); }

    // --- –ú–û–î–ê–õ–ö–ê –ò –°–ò–°–¢–ï–ú–ê ---
    const modal = document.getElementById('gameModal');
    const menu = document.getElementById('gameMenu');
    let activeIntervals = [];

    function openGameModal() { modal.style.display = 'flex'; backToMenu(); }
    function closeGameModal() { modal.style.display = 'none'; stopAllGames(); }
    function backToMenu() {
        stopAllGames();
        menu.style.display = 'grid';
        document.getElementById('gameTitle').innerText = '–ò–≥—Ä–æ–≤–æ–µ –ú–µ–Ω—é';
        ['forumContainer', 'clickerContainer', 'minesContainer', 'snakeContainer', 'geoContainer', 'casinoContainer'].forEach(id => {
            document.getElementById(id).style.display = 'none';
        });
    }
    function stopAllGames() { activeIntervals.forEach(clearInterval); activeIntervals = []; }

    // --- –ß–ê–¢ (–û–ë–ù–û–í–õ–ï–ù–ù–´–ô: GIF + ENTER) ---
    const firebaseConfig = { apiKey: "AIzaSyCesMs7AFeefzwVLhJfKyA3_QROoRnnONo", authDomain: "beerlanguage-1337.firebaseapp.com", projectId: "beerlanguage-1337", storageBucket: "beerlanguage-1337.firebasestorage.app", messagingSenderId: "18636363390", appId: "1:18636363390:web:aa02dfd1ce7e53f6d0aa2f" };
    firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();

    function openForum() {
        menu.style.display = 'none';
        document.getElementById('forumContainer').style.display = 'flex';
        document.getElementById('gameTitle').innerText = '–ñ–∏–≤–æ–π –ß–∞—Ç';
    }

    function findMediaLinks(text) {
        // –†–µ–≥—É–ª—è—Ä–∫–∞ –¥–ª—è –∫–∞—Ä—Ç–∏–Ω–æ–∫ –∏ –≥–∏—Ñ–æ–∫ (Imgur, Tenor, Giphy, Discord, Cappa.lol)
        const regex = /(https?:\/\/[^\s]+(\.jpg|\.png|\.gif|\.webp|tenor\.com\/view|giphy\.com\/gifs|imgur\.com\/|media\.discordapp\.net|cdn\.discordapp\.com|cappa\.lol)[^\s]*)/gi;
        return text.match(regex);
    }

    function escapeHtml(text) {
        const div = document.createElement('div');
        div.textContent = text;
        return div.innerHTML;
    }

    async function sendPost() {
        const name = document.getElementById('forumName').value || "–ê–Ω–æ–Ω–∏–º";
        const text = document.getElementById('forumText').value.trim();
        if (!text) return;
        await db.collection("posts").add({
            name: name,
            text: text,
            timestamp: firebase.firestore.FieldValue.serverTimestamp()
        });
        document.getElementById('forumText').value = "";
    }

    // –û–±—Ä–∞–±–æ—Ç–∫–∞ Enter –≤ —á–∞—Ç–µ
    document.getElementById('forumText').addEventListener('keydown', function(e) {
        if (e.key === 'Enter' && !e.shiftKey) {
            e.preventDefault();
            sendPost();
        }
    });
    
        const cont = document.getElementById('forumPosts');
        cont.innerHTML = "";
        snapshot.forEach((doc) => {
            const p = doc.data();
            const card = document.createElement("div");
            card.className = "post-card";
            
            let timeStr = "--:--";
            if (p.timestamp) {
                const date = p.timestamp.toDate();
                timeStr = date.getHours().toString().padStart(2,'0') + ":" + date.getMinutes().toString().padStart(2,'0');
            }

            let mediaHtml = "";
            const links = findMediaLinks(p.text || "");
            if (links) {
                links.forEach(link => {
                    mediaHtml += `<img src="${link}" class="post-img" onerror="this.style.display='none'">`;
                });
            }

            card.innerHTML = `
                <div class="post-author">${escapeHtml(p.name || '–ê–Ω–æ–Ω–∏–º')} <span>${timeStr}</span></div>
                <div class="post-text">${escapeHtml(p.text)}</div>
                ${mediaHtml}
            `;
            cont.appendChild(card);
        });
        cont.scrollTop = cont.scrollHeight;
    });

    // --- BEER CLICKER (–¢–í–û–ô –ü–û–õ–ù–´–ô –ö–û–î) ---
    let cookies = 0;
    let buildings = [
        { id: 0, name: '–ö—É—Ä—Å–æ—Ä', baseCost: 15, count: 0, cps: 0.1, icon: 'üëÜ' },
        { id: 1, name: '–ë–∞–±—É—à–∫–∞', baseCost: 100, count: 0, cps: 1, icon: 'üëµ' },
        { id: 2, name: '–ü–æ–ª–µ —Ö–º–µ–ª—è', baseCost: 1100, count: 0, cps: 8, icon: 'üåæ' },
        { id: 3, name: '–®–∞—Ö—Ç–∞ —Å–æ–ª–æ–¥–∞', baseCost: 12000, count: 0, cps: 47, icon: '‚õèÔ∏è' },
        { id: 4, name: '–ó–∞–≤–æ–¥', baseCost: 130000, count: 0, cps: 260, icon: 'üè≠' },
        { id: 5, name: '–ë–∞–Ω–∫', baseCost: 1400000, count: 0, cps: 1400, icon: 'üè¶' },
        { id: 6, name: '–•—Ä–∞–º', baseCost: 20000000, count: 0, cps: 7800, icon: 'üèõÔ∏è' },
        { id: 7, name: '–ú–∞—à–∏–Ω–∞ –≤—Ä–µ–º–µ–Ω–∏', baseCost: 330000000, count: 0, cps: 44000, icon: '‚è≥' }
    ];

    function getBuildingCost(b) { return Math.floor(b.baseCost * Math.pow(1.15, b.count)); }

    function openClicker() {
        menu.style.display = 'none';
        document.getElementById('clickerContainer').style.display = 'flex';
        document.getElementById('gameTitle').innerText = 'Beer Clicker';
        
        let saved = localStorage.getItem('beerClickerSave');
        if(saved) {
            let parsed = JSON.parse(saved);
            cookies = parsed.cookies;
            parsed.buildings.forEach((savedB, index) => {
                if(buildings[index]) buildings[index].count = savedB.count;
            });
        }
        
        renderStore();
        activeIntervals.push(setInterval(() => {
            let totalCps = buildings.reduce((sum, b) => sum + (b.count * b.cps), 0);
            cookies += totalCps / 10;
            updateClickerUI();
        }, 100));
    }

    function updateClickerUI() {
        document.getElementById('beerCount').innerText = Math.floor(cookies) + ' –ü–∏–≤–∞';
        let totalCps = buildings.reduce((sum, b) => sum + (b.count * b.cps), 0);
        document.getElementById('beerCps').innerText = '–≤ —Å–µ–∫—É–Ω–¥—É: ' + totalCps.toFixed(1);
        
        buildings.forEach(b => {
            let el = document.getElementById('building-' + b.id);
            if(el) {
                if(cookies >= getBuildingCost(b)) el.classList.remove('locked');
                else el.classList.add('locked');
            }
        });
    }

    function renderStore() {
        const store = document.getElementById('storeList');
        store.innerHTML = '';
        buildings.forEach(b => {
            const item = document.createElement('div');
            item.className = 'building-item locked';
            item.id = 'building-' + b.id;
            item.innerHTML = `
                <div class="b-icon">${b.icon}</div>
                <div class="b-info">
                    <div class="b-name">${b.name}</div>
                    <div class="b-cost">${getBuildingCost(b)} üç∫</div>
                </div>
                <div class="b-count">${b.count}</div>
            `;
            item.onclick = () => {
                let cost = getBuildingCost(b);
                if(cookies >= cost) {
                    cookies -= cost;
                    b.count++;
                    renderStore();
                    updateClickerUI();
                }
            };
            store.appendChild(item);
        });
    }

    function saveClicker() {
        localStorage.setItem('beerClickerSave', JSON.stringify({
            cookies: cookies,
            buildings: buildings.map(b => ({ count: b.count }))
        }));
    }

    document.getElementById('bigCookie').onclick = (e) => {
        cookies++;
        updateClickerUI();
        // –≠—Ñ—Ñ–µ–∫—Ç –≤—Å–ø–ª—ã–≤–∞—é—â–µ–π —Ü–∏—Ñ—Ä—ã +1
        const plus = document.createElement('div');
        plus.innerText = '+1';
        plus.style.position = 'absolute';
        plus.style.left = e.clientX - 10 + 'px';
        plus.style.top = e.clientY - 20 + 'px';
        plus.style.color = '#fff';
        plus.style.fontWeight = 'bold';
        plus.style.pointerEvents = 'none';
        plus.style.zIndex = '1000';
        document.body.appendChild(plus);
        let animY = e.clientY - 20;
        let opacity = 1;
        let anim = setInterval(() => {
            animY -= 2; opacity -= 0.05;
            plus.style.top = animY + 'px';
            plus.style.opacity = opacity;
            if(opacity <= 0) { clearInterval(anim); plus.remove(); }
        }, 30);
    };

    // --- –°–ê–ü–ï–† ---
    let minesGrid = [];
    function openMines() {
        menu.style.display = 'none';
        document.getElementById('minesContainer').style.display = 'flex';
        document.getElementById('gameTitle').innerText = '–°–∞–ø–µ—Ä';
        initMinesweeper();
    }
    function initMinesweeper() {
        const grid = document.getElementById('minesGrid');
        grid.innerHTML = '';
        minesGrid = [];
        let minesCount = 15;
        let cells = [];
        for(let i=0; i<100; i++) cells.push({ mine: false, revealed: false, count: 0 });
        for(let i=0; i<minesCount; i++) {
            let r = Math.floor(Math.random()*100);
            if(cells[r].mine) i--; else cells[r].mine = true;
        }
        cells.forEach((c, i) => {
            const cell = document.createElement('div');
            cell.className = 'mine-cell';
            cell.onclick = () => {
                if(c.mine) { alert('–ë–ê–ë–ê–•! –í—ã –ø—Ä–æ–∏–≥—Ä–∞–ª–∏.'); initMinesweeper(); }
                else {
                    cell.classList.add('revealed');
                    cell.innerText = '0';
                    cell.style.color = '#555';
                }
            };
            grid.appendChild(cell);
        });
    }

    // --- –ó–ú–ï–ô–ö–ê ---
    function openSnake() {
        menu.style.display = 'none';
        document.getElementById('snakeContainer').style.display = 'flex';
        document.getElementById('gameTitle').innerText = '–ó–º–µ–π–∫–∞';
        initSnakeGame();
    }
    function initSnakeGame() {
        const canvas = document.getElementById('snake-canvas');
        const ctx = canvas.getContext('2d');
        let score = 0;
        let snake = [{x: 10, y: 10}];
        let food = {x: 15, y: 15};
        let dx = 1, dy = 0;
        
        document.onkeydown = (e) => {
            if(e.key === 'ArrowUp' && dy === 0) { dx = 0; dy = -1; }
            if(e.key === 'ArrowDown' && dy === 0) { dx = 0; dy = 1; }
            if(e.key === 'ArrowLeft' && dx === 0) { dx = -1; dy = 0; }
            if(e.key === 'ArrowRight' && dx === 0) { dx = 1; dy = 0; }
        };

        activeIntervals.push(setInterval(() => {
            let head = {x: snake[0].x + dx, y: snake[0].y + dy};
            if(head.x < 0 || head.x >= 20 || head.y < 0 || head.y >= 20) { alert('–ò–≥—Ä–∞ –æ–∫–æ–Ω—á–µ–Ω–∞! –°—á–µ—Ç: ' + score); backToMenu(); return; }
            snake.unshift(head);
            if(head.x === food.x && head.y === food.y) {
                score++; document.getElementById('snakeScore').innerText = '–°—á–µ—Ç: ' + score;
                food = {x: Math.floor(Math.random()*20), y: Math.floor(Math.random()*20)};
            } else snake.pop();
            
            ctx.fillStyle = '#000'; ctx.fillRect(0,0,400,400);
            ctx.fillStyle = '#ea4335'; ctx.fillRect(food.x*20, food.y*20, 18, 18);
            ctx.fillStyle = '#81c995';
            snake.forEach(p => ctx.fillRect(p.x*20, p.y*20, 18, 18));
        }, 150));
    }

    // --- –§–õ–ê–ì–ò ---
    const flagData = [
        { f: 'üá∑üá∫', n: '–†–æ—Å—Å–∏—è' }, { f: 'üá∫üá∏', n: '–°–®–ê' }, { f: 'üá©üá™', n: '–ì–µ—Ä–º–∞–Ω–∏—è' }, { f: 'üá´üá∑', n: '–§—Ä–∞–Ω—Ü–∏—è' },
        { f: 'üáØüáµ', n: '–Ø–ø–æ–Ω–∏—è' }, { f: 'üá®üá≥', n: '–ö–∏—Ç–∞–π' }, { f: 'üá¨üáß', n: '–í–µ–ª–∏–∫–æ–±—Ä–∏—Ç–∞–Ω–∏—è' }, { f: 'üáßüá∑', n: '–ë—Ä–∞–∑–∏–ª–∏—è' },
        { f: 'üáÆüáπ', n: '–ò—Ç–∞–ª–∏—è' }, { f: 'üá∞üá∑', n: '–ö–æ—Ä–µ—è' }, { f: 'üá™üá∏', n: '–ò—Å–ø–∞–Ω–∏—è' }, { f: 'üá∞üáø', n: '–ö–∞–∑–∞—Ö—Å—Ç–∞–Ω' }
    ];
    let geoScore = 0;
    function openGeo() {
        menu.style.display = 'none';
        document.getElementById('geoContainer').style.display = 'flex';
        document.getElementById('gameTitle').innerText = '–£–≥–∞–¥–∞–π –§–ª–∞–≥';
        nextFlag();
    }
    function nextFlag() {
        const correct = flagData[Math.floor(Math.random()*flagData.length)];
        document.getElementById('geoFlag').innerText = correct.f;
        const opts = document.getElementById('geoOptions');
        opts.innerHTML = '';
        let options = [correct.n];
        while(options.length < 4) {
            let r = flagData[Math.floor(Math.random()*flagData.length)].n;
            if(!options.includes(r)) options.push(r);
        }
        options.sort(() => Math.random() - 0.5).forEach(o => {
            const b = document.createElement('button');
            b.className = 'geo-btn';
            b.innerText = o;
            b.onclick = () => {
                if(o === correct.n) { geoScore++; alert('–í–µ—Ä–Ω–æ!'); }
                else { geoScore = 0; alert('–û—à–∏–±–∫–∞! –≠—Ç–æ –±—ã–ª —Ñ–ª–∞–≥: ' + correct.n); }
                document.getElementById('geoScoreDisplay').innerText = '–°—á–µ—Ç: ' + geoScore;
                nextFlag();
            };
            opts.appendChild(b);
        });
    }

    // --- –ö–ê–ó–ò–ù–û ---
    let casinoBalance = 10;
    function openCasino() {
        menu.style.display = 'none';
        document.getElementById('casinoContainer').style.display = 'flex';
        document.getElementById('gameTitle').innerText = '–ü–∏–≤–Ω–æ–µ –ö–∞–∑–∏–Ω–æ';
        updateCasinoUI();
    }
    function updateCasinoUI() { document.getElementById('casinoBalance').innerText = '$' + casinoBalance; }
    function adjustBet(mult) {
        let bet = parseInt(document.getElementById('casinoBet').value);
        document.getElementById('casinoBet').value = Math.floor(bet * mult);
    }
    function playCasino() {
        let bet = parseInt(document.getElementById('casinoBet').value);
        if(isNaN(bet) || bet <= 0 || bet > casinoBalance) { alert('–ù–µ–≤–µ—Ä–Ω–∞—è —Å—Ç–∞–≤–∫–∞!'); return; }
        const msg = document.getElementById('casinoMsg');
        if(Math.random() < 0.45) {
            casinoBalance += bet;
            msg.innerText = '–í–´–ò–ì–†–ê–õ +$' + bet; msg.style.color = '#81c995';
        } else {
            casinoBalance -= bet;
            msg.innerText = '–ü–†–û–ò–ì–†–ê–õ -$' + bet; msg.style.color = '#ea4335';
        }
        updateCasinoUI();
        if(casinoBalance <= 0) { alert('–í—ã –≤—Å–µ –ø—Ä–æ–ø–∏–ª–∏! –í–æ—Ç –≤–∞–º $10 –Ω–∞ —É–¥–∞—á—É.'); casinoBalance = 10; updateCasinoUI(); }
    }

    // --- –ì–†–ê–í–ò–¢–ê–¶–ò–Ø ---
    let gravityInterval = null;
    function startGravity() {
        if(gravityInterval) { clearInterval(gravityInterval); gravityInterval = null; document.getElementById('main-block').style.transform = 'none'; return; }
        const block = document.getElementById('main-block');
        let y = 0, vy = 0;
        block.style.position = 'relative';
        gravityInterval = setInterval(() => {
            vy += 0.8; y += vy;
            if(y + block.offsetHeight > window.innerHeight - 50) { y = window.innerHeight - block.offsetHeight - 50; vy *= -0.5; }
            block.style.top = y + 'px';
        }, 20);
    }
</script>
</body>
</html>
